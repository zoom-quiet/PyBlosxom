<?xml version="1.0"?>
<!DOCTYPE content [ <!ENTITY nbsp " "> ]>
<rdf:RDF xml:base="/pyblosxom/rdf"
         xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/">

<rdf:Description rdf:about="/pyblosxom">
  <dc:title> Z<sub>en</sub>o<sub>f</sub>o<sub>pen</sub>M<sup>ind</sup>. Q<sub>uickly</sub>u<sub>tility</sub>i<sub>nternet</sub>e<sub>asy</sub>t<sup>echnic</sup> </dc:title>
  <dc:description> Zoom.Quiet's PyBlosxom blogging </dc:description>
  <dc:creator> Zoom.Quiet &lt;zoomquiet+blog [AT] gmail.com&gt; </dc:creator>
  <dc:language> zh </dc:language>
  <dc:format> text/html </dc:format>
  <dc:rights> Copyright 2001-2012 Zoom.Quiet </dc:rights>
</rdf:Description>

<rdf:Description rdf:about="/pyblosxom/utility/Subversion/ra_dev-svn-2007-10-15-11-33">
  <dc:title> SVN 无法识别的url方案  </dc:title>
  <dc:creator> Zoom.Quiet &lt;zoomquiet+blog [AT] gmail.com&gt; </dc:creator>
  <dc:date> 2007-10-15T03:33:00Z </dc:date>
  <dc:language> zh </dc:language>
  <dc:format> text/html </dc:format>
  <dc:rights> Copyright 2001-2012 Zoom.Quiet </dc:rights>

  <content>
    <div class="header" id="header">
<a name='toptopS05MRTRJS' id='toptopS05MRTRJS'></a><h1>SVN 无法识别的url方案 </h1>
<h2>-- 解决...记要</h2>
</div>

<div class="toc" id="toc">
  <ol>
  <li><a href="#toc1R0VYQ0JaN">现象</a>
    <ul>
    <li><a href="#toc2R0VYRENMU">1.1. 原因</a>
    </li>
    <li><a href="#toc3R0VYREVMU">1.2. 解决</a>
    </li>
    <li><a href="#toc4R0VYREdMU">1.3. 心得</a>
    </li>
    </ul>
  </li>
  </ol>

</div>
<div class="body" id="body">
<a id="toc1R0VYQ0JaN" name="toc1R0VYQ0JaN"></a>
<h1><A href='#toptopS05MRTRJS'> 1. 现象 </A></h1>
<dl>
<dt>突然之间访问不能:</dt><dd>
<pre>
svn: 无法识别的URL方案(一般需要svn://，http://，file://等开头)
“http://svn.rdev.kingsoft.net/kdoc/tangle/KsPIG/Zoom.Quiet/S5”
</pre>
</dd>
</dl>

<a id="toc2R0VYRENMU" name="toc2R0VYRENMU"></a>
<h2><A href='#toptopS05MRTRJS'> 1.1. 原因 </A></h2>
<dl>
<dt>根据:</dt><dd>
 <ul>
 <li><a href="http://blog.yesky.com/223/sxy519/1716723.shtml">http://blog.yesky.com/223/sxy519/1716723.shtml</a> 建议的一看才知道...
<pre>
$ svn --version
svn，版本 1.4.3 (r23084)
   编译于 Oct 12 2007，13:28:55

版权所有 (C) 2000-2007 CollabNet。
Subversion 是开放源代码软件，请参阅 http://subversion.tigris.org/
此产品包含由 CollabNet (http://www.Collab.Net/)开发的软件。

可使用以下的仓库存取 (RA) 模块:

* ra_svn : 使用svn网络协议访问仓库的模块。
  - 处理“svn”方案
* ra_local : 访问本地磁盘的仓库模块。
  - 处理“file”方案
</pre>
 </li>
 <li>FT! Ubuntu自动升级时，没有完整的升级SVN哪！
 </li>
 </ul>
</dd>
</dl>

<a id="toc3R0VYREVMU" name="toc3R0VYREVMU"></a>
<h2><A href='#toptopS05MRTRJS'> 1.2. 解决 </A></h2>
<dl>
<dt>使用新立得:</dt><dd>
 <ul>
 <li>重新安装SVN 相关所有 
 </li>
 <li>问题依然...
 </li>
 </ul>
</dd>
<dt>编译!</dt><dd>
 <ul>
 <li>GNU/Linux 下面一般就这板斧招了!
<pre>
$ wget -c http://subversion.tigris.org/downloads/subversion-deps-1.4.5.tar.bz2 &amp;
$ wget -c http://subversion.tigris.org/downloads/subversion-1.4.5.tar.bz2 &amp;
$ tar xjvf subversion-1.4.5.tar.bz2 
$ tar xjvf subversion-deps-1.4.5.tar.bz2 
$ cd subversion-1.4.5
$ ./configure
$ make
$ sudo make install clean
...
</pre>
 </li>
 <li>FT!!怎么还是没有<code>ra_dav</code>模块?! 
<pre>
$ whereis svn
svn: /usr/bin/svn /usr/X11R6/bin/svn /usr/bin/X11/svn /usr/local/bin/svn /usr/share/man/man1/svn.1.gz
$ /usr/local/bin/svn --version
svn，版本 1.4.5 (r25188)
   编译于 Oct 15 2007，11:03:39

版权所有 (C) 2000-2007 CollabNet。
Subversion 是开放源代码软件，请参阅 http://subversion.tigris.org/
此产品包含由 CollabNet (http://www.Collab.Net/)开发的软件。

可使用以下的仓库访问模块: 

* ra_dav : 通过WebDAV(DeltaV)协议访问仓库的模块。
  - 处理“http”方案
* ra_svn : 使用svn网络协议访问仓库的模块。
  - 处理“svn”方案
* ra_local : 访问本地磁盘的仓库模块。
  - 处理“file”方案
</pre>
 </li>
 </ul>
</dd>
</dl>

<dl>
<dt>解决:</dt><dd>
 <ul>
 <li>原来默认的<code>/usr/bin/svn</code> 还是原先安装的 1.4.3 版本
 </li>
 <li>手工处理一下
<pre>
$ sudo mv /usr/bin/svn /usr/bin/svn143
$ sudo ln -s /usr/local/bin/svn /usr/bin/svn
</pre>
 </li>
 <li>哗,世界恢复正当!
 </li>
 </ul>
</dd>
</dl>

<a id="toc4R0VYREdMU" name="toc4R0VYREdMU"></a>
<h2><A href='#toptopS05MRTRJS'> 1.3. 心得 </A></h2>
<ol>
<li>确认现象
</li>
<li>搜索资料
</li>
<li>编译
</li>
<li>测试调整
<p></p>
<code>嗯嗯嗯~自由世界中的不二法典哪!解决问题的...</code>
</li>
</ol>

<hr class="light" />
<p>
动力源自::<b><a href="http://txt2tags.sf.net">txt2tags</a></b>
</p>
<p>
<img align="middle" src="/pybimage/technorati-over.gif" border="0" alt=""/>
    <a href="http://www.technorati.com/tags/FLOSS">OpenSource</a>
    ,<a href="http://www.technorati.com/tags/Subversion">Subversion</a>
</p>
</div>

<!-- xhtml code generated by txt2tags 2.4 (http://txt2tags.sf.net) -->
<!-- cmdline: txt2tags ./utility/Subversion/ra_dev-svn-2007-10-15-11-33.t2t -->

  </content>

  <rdf:Seq>

<rdf:Description rdf:about="/pyblosxom/utility/Subversion/update-svn-2006-05-28-12-00">
  <dc:title> 升级SVN </dc:title>
  <dc:creator> Zoom.Quiet &lt;zoomquiet+blog [AT] gmail.com&gt; </dc:creator>
  <dc:date> 2006-05-28T04:00:00Z </dc:date>
  <dc:language> zh </dc:language>
  <dc:format> text/html </dc:format>
  <dc:rights> Copyright 2001-2012 Zoom.Quiet </dc:rights>

  <content>
    <div class="header" id="header">
<a name='toptopNFdHWVBaN' id='toptopNFdHWVBaN'></a><h1>升级SVN</h1>
<h2>--体验如何管理多SVN仓库</h2>
<h3>t2t渲染:: 2010-10-09 02:18:13</h3>
</div>

<div class="toc" id="toc">
  <ol>
  <li><a href="#toc1R0VYQ0JaT">原因</a>
  </li>
  <li><a href="#toc2R0lYQ0IyR">过程</a>
  </li>
  </ol>

</div>
<div class="body" id="body">
<a id="toc1R0VYQ0JaT" name="toc1R0VYQ0JaT"></a>
<h1><A href='#toptopNFdHWVBaN'> 1. 原因 </A></h1>
<dl>
<dt>SVN新版本:</dt><dd>
    1.3.1 VS 1.2.0 有了各种功能的提升!
</dd>
</dl>

<a id="toc2R0lYQ0IyR" name="toc2R0lYQ0IyR"></a>
<h1><A href='#toptopNFdHWVBaN'> 2. 过程 </A></h1>
<dl>
<dt>规划:</dt><dd>
    <ol>
    <li>怎么
    <p></p>
    </li>
    </ol>
</dd>
<dt>变化:</dt><dd>
    <ol>
    <li>怎么
    <p></p>
= 总结 =
    <p></p>
    </li>
    </ol>
</dd>
<dt>规划:</dt><dd>
    <ol>
    <li>怎么
    <p></p>
    </li>
    </ol>
</dd>
<dt>变化:</dt><dd>
    <ol>
    <li>怎么
    <p></p>
<hr class="light" />
动力源自::<b><a href="http://txt2tags.sf.net">txt2tags</a></b>
    </li>
    </ol>
</dd>
</dl>

<p>
<img align="middle" src="/pybimage/technorati-over.gif" border="0" alt=""/>
    <a href="http://www.technorati.com/tags/OpenSource">OpenSource</a>
    ,<a href="http://www.technorati.com/tags/Subversion">Subversion</a>
</p>
</div>

<!-- xhtml code generated by txt2tags 2.4 (http://txt2tags.sf.net) -->
<!-- cmdline: txt2tags ./utility/Subversion/update-svn-2006-05-28-12-00.t2t -->

  </content>

  <rdf:Seq>

<rdf:Description rdf:about="/pyblosxom/utility/Subversion/hooks/post-commit">
  <dc:title> post-commit.py </dc:title>
  <dc:creator> Zoom.Quiet &lt;zoomquiet+blog [AT] gmail.com&gt; </dc:creator>
  <dc:date> 2006-05-01T15:23:00Z </dc:date>
  <dc:language> zh </dc:language>
  <dc:format> text/html </dc:format>
  <dc:rights> Copyright 2001-2012 Zoom.Quiet </dc:rights>

  <content>
    <pre class="brush: python">#!/usr/local/bin/python
#tags utility,Subversion,hooks
#coding=utf-8
"""
SVN 事务日志处理
    - 使用固定的参数来自动响应检入后续操作:
        - 记录检入活动信息到每日log文件
"""
##  Zoomq::060110 fixed log exp. esp. for woodpecker repo.
## only record commit-log of woodpecker


import sys,os,time

CHMOD = "/bin/chmod"
CHOWN = "/usr/sbin/chown"
LOOK = "/usr/local/bin/svnlook"
SVN = "/usr/local/bin/svn"
log="/var/log/svn/woodpecker-ci.log"
daylog = "%s-%s.log"%(log[:-4]
                    ,time.strftime("%y%m%d",
                                    time.localtime()))
LOGFILE = daylog
f = open( LOGFILE, "a+" )
TSTAMP = "%s"%time.strftime("%y-%m-%d %H:%M:%S", time.localtime())

### hook matter
MARK = "woodpecker"
MOD = "woodpecker"
AIM = "/path/to/woodpecker/repos/"
def autoco(dirs,svn,mark,aim,mod):
    """auto co all matter files:
        - svn SVNLOOK where
        - mark the mark of matter
        - aim where want to co
        - mod 指定的模块
    """
    print >> f,dirs
    if mark in dirs:
        print >> f,TSTAMP+" marked::OK! up::"+aim+mod
        upsvn = svn+" update %s"%(aim+mod)
        print >> f,TSTAMP+upsvn
        up = os.popen(upsvn).read().strip()
        print >> f,up
    else:
        print >> f,TSTAMP+" marked::NO! up::nothing"
def changedirs(look,rev,repos):
    """list all changed dir
    """
    dirs = os.popen( look+" changed -r "+ rev + " " + repos).read().strip()
    return dirs
def chkdirmod(cmod,cown,path,umark):
    """chmod and chown the aim path
    """
    exp = os.popen(cmod+" -R "+umark+" "+path).read().strip()
    exp += os.popen(cown+" -R www:www "+path).read().strip()    
    return exp
def logcommit(look,rev,repos):
    """log commit info...
    """
    log = os.popen( look+" author -r "+ rev + " "+ repos).read().strip()
    print >> f," "*4+"%s commited;%s"%(str(log),repos)
    #return log..
    
def usage():
    print "Usage: " + sys.argv[0] + " REPOS REV\n"
    print >> f,TSTAMP+"Usage: " + sys.argv[0] + " REPOS REV"
    sys.exit(0)

if __name__ == '__main__':
    if len(sys.argv) != 3:
        usage()
    # start hook matter...
    repos = sys.argv[1]
    rev = sys.argv[2]        
    print >> f,TSTAMP+" >>>>>> woodpecker up rev::"+rev
    print >> f,changedirs(LOOK,rev,repos)
    logcommit(LOOK,rev,repos)
    
    print >> f,TSTAMP+" <<<<<< woodpecker repo commit DONE! "
    </pre>
  </content>

  <rdf:Seq>

<rdf:Description rdf:about="/pyblosxom/utility/Subversion/intoSVN-2006-01-01-23-23">
  <dc:title> Subversion </dc:title>
  <dc:creator> Zoom.Quiet &lt;zoomquiet+blog [AT] gmail.com&gt; </dc:creator>
  <dc:date> 2006-01-01T15:23:00Z </dc:date>
  <dc:language> zh </dc:language>
  <dc:format> text/html </dc:format>
  <dc:rights> Copyright 2001-2012 Zoom.Quiet </dc:rights>

  <content>
    <div class="header" id="header">
<a name='toptopS04yV0U1V' id='toptopS04yV0U1V'></a><h1>Subversion</h1>
<h2>为了颠覆CVS的版本管理系统！</h2>
</div>

<div class="toc" id="toc">
  <ol>
  <li><a href="#toc1R0VYQ0FVM">SVN vs CVS</a>
  </li>
  <li><a href="#toc2R0lYQ0JaT">啄木鸟的体验</a>
  </li>
  <li><a href="#toc3R01YQ0E1U">v1.3.0体验</a>
    <ul>
    <li><a href="#toc4R01YRENMU">3.1. 继续</a>
    </li>
    </ul>
  </li>
  </ol>

</div>
<div class="body" id="body">
<a id="toc1R0VYQ0FVM" name="toc1R0VYQ0FVM"></a>
<h1><A href='#toptopS04yV0U1V'> 1. SVN vs CVS </A></h1>
<p>
在本地使用自个儿习惯的格式来写，通过SVN 自动版本同步到PyBlsxom发布！
</p>
<dl>
<dt>好处：</dt><dd>
    <ol>
    <li>使用DB4有事务支持
    </li>
    <li>二进制文件可版本管理
    </li>
    <li>速度快！
    </li>
    <li>离线操作丰富
    </li>
    <li>...
    </li>
    </ol>
</dd>
<dt>坏处:</dt><dd>
    <ul>
    <li>使用DB 数据可能<i>变脏</i>
    </li>
    <li>DB4 管理复杂
     <ul>
     <li>不过，到了1.2.1以后也支持CVS样儿的文件型数据管理了
    -
     </li>
     </ul>
    </li>
    </ul>
</dd>
</dl>

<a id="toc2R0lYQ0JaT" name="toc2R0lYQ0JaT"></a>
<h1><A href='#toptopS04yV0U1V'> 2. 啄木鸟的体验 </A></h1>
<p>
很早就使用SVN 进行代码管理了，统一的体验就是快！
</p>
<p>
<a href="http://cvs.woodpecker.org.cn/trac/">trac of 啄木鸟</a>
</p>
<p>
<a href="http://wiki.woodpecker.org.cn/moin/AllAboutSubversion">啄木鸟SVN使用说明</a>
</p>
<a id="toc3R01YQ0E1U" name="toc3R01YQ0E1U"></a>
<h1><A href='#toptopS04yV0U1V'> 3. v1.3.0体验 </A></h1>
<dl>
<dt>FreeBSD6.0 为准:</dt><dd>
    <ol>
    <li>升级ports:
        <ul>
        <li><code>portsnap upgrade</code>
        </li>
        <li>比以前的什么
        <code>cvsup -sgL2 /usr/share/examples/cvsup/ports-supfile -h cvsup{,2-6}.cn.freebsd.org</code> 
        要直接的多
        </li>
        </ul>
    </li>
    <li>安装SVN:
<pre>
# cd /usr/ports/devel/subversion
# make install clean
</pre>
    </li>
    <li>创建SVN仓库:
        <ul>
        <li><code>svnadmin create --fs-type fsfs /path/to/ur/svnrepo</code>
        </li>
        <li>建立使用 <a href="http://www.subversion.org.cn/svnbook/1.1/svn-ch-5.html#svn-ch-5-sect-1.3">FSFS 存储的仓库</a>
        </li>
        </ul>
    </li>
    <li>启动服务:
        <ul>
        <li>选择<b>svnserve</b>:
        </li>
        <li><a href="http://www.subversion.org.cn/svnbook/1.1/svn-ch-6.html#svn-ch-6-sect-1">根据对比</a>
        </li>
        <li><b>svnserve</b> 模式依赖最小,管理也方便，速度还快！
        </li>
        </ul>
        <ol>
        <li>inetd 方法启动:
            <ul>
            <li>确认:
<pre>
    /etc/services 有
svn           3690/tcp   # Subversion
svn           3690/udp   # Subversion
    /etc/inetd.conf 有
svn stream tcp nowait svnowner /usr/bin/svnserve svnserve -i

</pre>
            </li>
            <li><code>svnserve -i</code> 命令启动
            </li>
            <li>每有请求，就会创建一个svnserve进程，处理完后自杀
            </li>
            </ul>
        </li>
        <li>作为独立“守护”进程:
            <ul>
            <li>直接<code>svnserve -d --listen-port=和--listen-host=</code>
            选项来自定义“绑定”的端口和主机名启动
            </li>
            <li>创建一个驻留内存的进程来影响SVN事务
            </li>
            <li>也可限制发布:
<pre>
svnserve -d -r /path/to/ur/svnrepos/
</pre>
            仅仅发布指定的SVN仓库，这样一来访问时就不用知道服务端系统路径了
            </li>
            </ul>
        </li>
        </ol>
    </li>
    <li>权限管理:
        <ul>
        <li>1.3.0 的SVN提供了足够好用的默许权限控制！
        不用什么 Apache 的额外支持就足够进行管理了!
        </li>
        <li><i>svnserve.conf</i>中指定:
<pre>
password-db = passwd
authz-db = authz
...
</pre>
        </li>
        <li>就可以在 <b>passwd</b> 文件中定义口令
<pre>
[users]
harry = harryssecret
sally = sallyssecret
...
</pre>
        </li>
        <li><b>authz</b> 中进行用户组，代码目录访问权限的分配了
<pre>
[groups]
harry_and_sally = harry,sally
[/foo/bar]
harry = rw
* = 
[repository:/baz/fuz]
@harry_and_sally = rw
* = r
</pre>
        </li>
        <li>比以前的只能口令，要丰富，足够的很多了！
        </li>
        </ul>
    </li>
    <li>备份管理:
        <ul>
        <li><b>hotcopy</b> 真实可用的热备！
<pre>
svnadmin hotcopy /path/to/ur/repos /path/to/backup/ &amp;
</pre>
        </li>
        </ul>
    </li>
    <li>事务管理:
        <ul>
        <li>高级，但是实用有趣的 
        <b><a href="http://wiki.woodpecker.org.cn/moin/SubversionHooks">HOOKs</a></b> 技术了！
        </li>
        <li>最基础的 ，将<code>post-commit.tmpl</code> cp 为 post-commit,
        加入你自个儿的事务脚本
<pre>
HOOKS="/path/to/ur/repos/hooks/script"
$HOOKS/post-commit.py "$REPOS" "$REV"
</pre>
        </li>
        <li>啄木鸟现在使用的 <a href="/pyblosxom/OpenSource/Subversion/hooks/post-commit.phtm">post-commit.py</a>自动将检入活动记录在案
        </li>
        </ul>
    </li>
    </ol>
</dd>
</dl>

<a id="toc4R01YRENMU" name="toc4R01YRENMU"></a>
<h2><A href='#toptopS04yV0U1V'> 3.1. 继续 </A></h2>
<p>
以上是快记，具体使用中的体会，妙处要长期发现记录在案 的…………
</p>
<hr class="light" />
<ul>
<li>动力源自::<b><a href="http://txt2tags.sf.net">txt2tags</a></b>
</li>
<li>t2t渲染:: 2010-10-09 02:21:36
</li>
</ul>

<p>
<img align="middle" src="/pybimage/technorati-over.gif" border="0" alt=""/>
    <a href="http://www.technorati.com/tags/OpenSource">OpenSource</a>
    ,<a href="http://www.technorati.com/tags/Subversion">hacking</a>
</p>
</div>

<!-- xhtml code generated by txt2tags 2.4 (http://txt2tags.sf.net) -->
<!-- cmdline: txt2tags ./utility/Subversion/intoSVN-2006-01-01-23-23.t2t -->

  </content>

  <rdf:Seq>

  </rdf:Seq>
</rdf:Description>
</rdf:RDF>
