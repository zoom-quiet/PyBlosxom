<head>
  <title>Zoom.Quiet's PyBlosxom blogging</title>
<!--
  <title>Zoom.Quiet's PyBlosxom blogging  05 2010 by pyblosxom1.5.2</title>
-->
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="/pybstyle/pyblosxom.ico" type="image/x-icon" />
<link rel="icon" href="/pybstyle/pyblosxom.ico" type="image/x-icon" />

<link rel="stylesheet" type="text/css"  href="/pybstyle/html.flav/style.css" />
<link rel="stylesheet" type="text/css"  media="print" href="/pybstyle/html.flav/print.css" />

</head>
<body>

<div class="container"> 
<table><!-- main page structure-->
<tr>
<td><!-- id="head" 
    <div id="header" class="g33"> 
        <h2><a href="/pyblosxom">
        <img src="/pybstyle/zoomquiet-means-100414_h90.png" alt="Z<sub>en</sub>o<sub>f</sub>o<sub>pen</sub>M<sup>ind</sup>. Q<sub>uickly</sub>u<sub>tility</sub>i<sub>nternet</sub>e<sub>asy</sub>t<sup>echnic</sup>">
        </a>
        </h2> 
    </div> 

    <div id="top" class="g33"> 
        <div id="description" class="g16 alpha"> 
        <h3>Zoom.Quiet's PyBlosxom blogging
        </h3>
        </div>
-->
    <div id="top" class="g33"> 
        <div id="description" class="g16 alpha"> 
            <h3><a href="/pyblosxom">
            <img src="/pybstyle/zoomquiet-pyb-110831.png" alt="Zoom.Quiet's PyBlosxom blogging">
            </a>
            </h3>
        </div>

        <div id="feeds"> 
        <!-- rss-popup usage div... 
<div id="feeds" class="g16 omega" style="text-align:right;"> 
<div class="rss-popup">
        <a href="/pyblosxom/index.atom" id="rss-icon">RSS Feed</a>
        <em>Subscribe the RSS Feed</em>
</div>        
        -->
        <span class="feeds">
            <a href="/pyblosxom/index.atom" alt="atom"><img src="/pybstyle/rss-16x16.png"/></a>
        </span>
        <sup>
        <a href="/pyblosxom/category-index.html">树</a>
        </sup><sub>
        <a style="text-decoration=none" href="/pyblosxom/site-index.html">引</a>
        </sub>

        </div> <!--id="feeds"-->
    </div> <!--id="top" class="g33"-->

<hr id="split"/>


<!--
    <div class="clear"></div> 
<p>-- </p>
-->    
</td><!-- id="head" -->
</tr>
<tr><td><!-- id="main" -->

<div id="content" class="g33">
<div id="main" class="g29">

<!--<h2>Mon, 31 May 2010</h2>-->
<!--for firstdaydiv.py 
    <span class="blosxomDate">Mon, 31 May 2010</span>
-->
<div class="post"> 
<div id="page-content">

    <div class="pt">
        <h1>&para; index_static.py</h1>
        <h2 class="permanentURL">
        <a href="/pyblosxom/techic/PyBlosxom/plugins/index_static.html">2010-05-31 11:10</a>
        </h2>
        <!--Mon, 31 May 2010-->
    </div>

    <div class="text">
        <div class="blosxomStory">
        <pre class="brush: python"># -*- coding: utf-8 -*-
"""
index_static.py
    - just fixed for pyblosxom-cmd  staticrender export all .html links
base index.py from:
http://snarfed.org/space/pyblosxom+index
Ryan Barrett <pyblosxom@ryanb.org>

This plugin displays an alphabetical index of all entries. It uses these
optional config variables from config.py, shown here with their defaults:

py['index_trigger']            = '/site-index'
py['index_num_columns']        = 2
py['index_letters_first']      = True
py['index_title']              = 'index'
py['index_use_story_template'] = True


VERSION:
0.2

TODO:
- use a template instead of hard-coded HTML

Copyright 2006 Ryan Barrett

This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.
"""
import math
import os.path
import time
from Pyblosxom import tools
import Pyblosxom.entries

__author__ = 'Ryan Barrett'
__version__ = '0.2'
__url__ = 'http://snarfed.org/space/pyblosxom+index'
__description__ = 'Displays an alphabetical index of all entries.'


def verify_installation(request):
  return 1

def cb_filelist(args):
  request = args['request']
  http = request.getHttp()
  data = request.getData()
  config = request.getConfiguration()

  trigger = config.get('index_trigger', 'site-index')
  if http['PATH_INFO'] != trigger:
    return

  # get the entries
  datadir = config['datadir']
  files = tools.Walk(request, datadir)
  files.sort()

  # sort into sections, one for each letter. the dictionary is 
  # letter => (entry name, path) where path is the relative to datadir.
  sections = {}
  entry_extensions = data['extensions'].keys()

  for file in files:
    assert file.startswith(datadir)
    path, ext = os.path.splitext(file[len(datadir):])
    if ext[1:] in entry_extensions:  # strip the leading period from ext
      entry_name = os.path.basename(path)
      sections.setdefault(entry_name[0].upper(), []).append((entry_name, path))

  # extract the first letters. sort as usual, except that numbers and other
  # non-letters go *after* letters. 
  def letters_before_symbols(a, b):
    if a.isalpha() and not b.isalpha():
      return -1
    elif not a.isalpha() and b.isalpha():
      return 1
    else:
      return cmp(a, b)

  letters = sections.keys()
  if config.get('index_letters_first', 1):
    letters.sort(letters_before_symbols)
  else:
    letters.sort()

  # add the header with links to each section
  body = '<p class="index-header">'
  letter_links = ['<a href="#%s">%s</a>' % (l, l) for l in letters]
  body += ' |\n'.join(letter_links)
  body += '</p>\n<hr class="index"/>\n\n'

  # add the sections themselves, with one link per entry, in a table. the
  # number of columns is taken from the index_num_columns config variable.
  # entries are ordered down each column, in order.
  num_cols = config.get('index_num_columns', 2)

  for l in letters:
    body += '<h3 class="index">%s</h3> <a name="%s"></a n>\n' % (l, l)
    body += '<table class="index">\n'

    entries = sections[l]
    entries.sort()
    num_rows = int(math.ceil(float(len(entries)) / num_cols))

    for row in range(0, num_rows):
      # alternate the <tr> tags' class between index-row-stripe-0 and
      # index-row-stripe-1, so you can use CSS to alternate their color for
      # readability, if you want.
      body += '<tr class="index-row-stripe-%d">\n' % (row % 2)
      for col in range(0, num_cols):
        entry_index = col * num_rows + row
        if entry_index < len(entries):
          entry_name, path = entries[entry_index]
        else:
          entry_name = path = ''
        body += '<td><a href="%s.html">%s</a></td>\n' % (path[1:], entry_name)
      body += '</tr>\n'

    body += '</table>\n<hr class="index"/>\n\n'

  data = {'title': config.get('index_title', 'index')}
  # use the epoch for mtime. otherwise, pyblosxom uses the current time, which
  # makes other plugins (like weblogsping) think this is a new entry.
  epoch = time.localtime(0)
  fe = Pyblosxom.entries.base.generate_entry(request, data, body, epoch)
  return [fe]

def cb_story(args):
  request = args['request']
  http = request.getHttp()
  config = request.getConfiguration()
  trigger = config.get('index_trigger', 'site-index')

  if (http['PATH_INFO'] == trigger and
      not config.get('index_use_story_template', 1)):
    title = config.get('index_title', 'index')
    args['template'] = '<h1 class="index">%s</h1>\n<hr />\n$body' % title

  return args
</pre>
        </div>

<br/>
        <div class="meta"> &sect; 
写于: Mon, 31 May 2010 | <a href="/pyblosxom/techic/PyBlosxom/plugins/index_static.html">永久链接</a>;源文:
<a href="/pyblosxom/techic/PyBlosxom/plugins/index_static.rdf">rdf</a>
,<a href="/pyblosxom/techic/PyBlosxom/plugins/index_static.atom">rss</a>
,<a href="/pybnodes/techic/PyBlosxom/plugins/index_static.t2t">raw</a>
| 分类: <a href="/pyblosxom/techic/PyBlosxom/plugins" title="path">/techic/PyBlosxom/plugins</a>
&sect;
<br/>
<a href="mailto:zoomquiet+blog@gmail.com?subject={PyBlosxom}index_static.py&body=abt. techic/PyBlosxom/plugins/index_static">[MailMe]</a>
<a href="javascript:window.print()">[Print]</a>
 <a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/cn/">
<img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/2.5/cn/80x15.png" /></a>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="E73UR2XVSP7US">
<input type="image" src="http://blog.zoomquiet.org/pybimage/icon/dollar_32.png" border="0" name="submit" alt="PayPal——最安全便捷的在线支付方式！">
<img alt="" border="0" src="https://www.paypalobjects.com/zh_XC/i/scr/pixel.gif" width="1" height="1">
</form>

<br/>
<span class="cclicence">
    &#26412;<span xmlns:dc="http://purl.org/dc/elements/1.1/" href="http://purl.org/dc/dcmitype/Text" rel="dc:type">&#20316;&#21697;</span>&#30001;<span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">Zoom.Quiet</span>&#21019;&#20316;&#65292;&#37319;&#29992;<a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/cn/">&#30693;&#35782;&#20849;&#20139;&#32626;&#21517;-&#30456;&#21516;&#26041;&#24335;&#20849;&#20139; 2.5 &#20013;&#22269;&#22823;&#38470;&#35768;&#21487;&#21327;&#35758;</a>&#36827;&#34892;&#35768;&#21487;&#12290;
&#22522;&#20110;<a xmlns:dc="http://purl.org/dc/elements/1.1/" href="/pyblosxom/techic/PyBlosxom/plugins/index_static.html" rel="dc:source">zoomquiet.org</a>&#19978;&#30340;&#20316;&#21697;&#21019;&#20316;&#12290;
</span>

<br/>
<!-- for Disqus actions -->
<div id="disqus_thread"></div>
<!-- for Disqus actions -->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'zoomquietpyblosxomblogging'; // required: replace example with your forum shortname
    // The following are highly recommended additional parameters. Remove the slashes in front to use.
    var disqus_identifier = "techic/PyBlosxom/plugins/index_static.html";
    var disqus_url = "http://blog.zoomquiet.org/pyblosxom/techic/PyBlosxom/plugins/index_static.html";

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<!--<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
<center id="pyentrynavi">
    
</center>
-->
    </div> <!--class="meta"-->

    </div> <!-- class="text"-->

</div> <!-- id="page-content"-->
</div> <!-- class="post"-->
<hr/> 

<div class="post"> 
<div id="page-content">

    <div class="pt">
        <h1>&para; hardcodedates.py</h1>
        <h2 class="permanentURL">
        <a href="/pyblosxom/techic/PyBlosxom/plugins/hardcodedates.html">2010-05-31 11:10</a>
        </h2>
        <!--Mon, 31 May 2010-->
    </div>

    <div class="text">
        <div class="blosxomStory">
        <pre class="brush: python"># -*- coding: utf-8 -*-
from Pyblosxom import tools
import os, os.path, posix, re, stat, time

FILETIME = re.compile('^([0-9]{4})-([0-1][0-9])-([0-3][0-9])-([0-2][0-9])-([0-5][0-9]) +(.*)$')

all_timestamps = {}
extensions = []
timestamps_to_save = {}


#mode: python; indent-tabs-mode: t, tab-width: 4 
"""
This allows the user to create a file "timestamps" in their datadir,
that will override the timestamp of any given blog entry. Each line
in this file should be of the form "YYYY-MM-DD-hh-mm file-name".
Then for any entry that one of these lines exist the system will use
that timestamp instead of the actual files modification time.

Note: the filename is relative to your data-dir.
Example of a line for the file /var/data-dir/school/abc.txt
   where the datadir is "/var/data-dir/" and the date is Aug 9, 2004.

2004-08-09-00-00 school/abc.txt
"""
__author__ = 'Nathan Kent Bullock, Ryan Barrett'
__homepage__ = 'http://snarfed.org/space/hardcodedates'
__email__ = 'nathan_kent_bullock -at- yahoo.ca, hardcodedates -at- ryanb.org'
__version__ = '1.4'
def init(request):
    if all_timestamps:
        return  # already initialized

    datadir = request.getConfiguration()['datadir']
    timestamp_file = os.path.join(datadir, 'timestamps')

    if os.path.isfile(timestamp_file):
        f = file(timestamp_file)
        for str in f.readlines():
            m = FILETIME.search(str.strip())
            if m:
                year = int(m.group(1))
                mo = int(m.group(2))
                day = int(m.group(3))
                hr = int(m.group(4))
                minute = int(m.group(5))
                mtime = time.mktime((year,mo,day,hr,minute,0,0,0,-1))
                filename = os.path.join(datadir, m.group(6))
                all_timestamps[filename] = mtime

        f.close()

    extensions.extend(request.getData()['extensions'].keys())
    extensions.append(request.getConfiguration().get('comment_ext', 'cmt'))

def cb_filestat(args):
    request = args['request']
    init(request)

    filename = args['filename']
    extension = os.path.splitext(filename)[1][1:]
    datadir = request.getConfiguration()['datadir']

    if all_timestamps.has_key(filename):
        # we know this file's timestamp
        mtime = args['mtime']
        assert isinstance(mtime, (tuple, posix.stat_result))
        args['mtime'] = (mtime[0:stat.ST_MTIME] + (all_timestamps[filename],) +
                         mtime[stat.ST_MTIME + 1:])

    elif extension in extensions and filename.startswith(datadir):
        # we don't know it, but we should. ask the os for it, and remember it.
        args['mtime'] = os.stat(filename)
        all_timestamps[filename] = args['mtime'][stat.ST_MTIME]
        timestamps_to_save[filename] = args['mtime'][stat.ST_MTIME]

    return args

def cb_end(args):
    if timestamps_to_save:
        datadir = args['request'].getConfiguration()['datadir']
        datadir = os.path.normpath(datadir)
        tsfile = file(os.path.join(datadir, 'timestamps'), 'a')
        for filename, mtime in timestamps_to_save.items():
            time_str = time.strftime('%Y-%m-%d-%H-%M', time.localtime(mtime))
            # strip the datadir prefix and directory separator slash
            filename = filename[len(datadir) + 1:]
            tsfile.write('%s %s\n' % (time_str, filename))
            tools.getLogger().info('Saved mtime %s for %s' % (time_str, filename))
        tsfile.close()
        timestamps_to_save.clear()

</pre>
        </div>

<br/>
        <div class="meta"> &sect; 
写于: Mon, 31 May 2010 | <a href="/pyblosxom/techic/PyBlosxom/plugins/hardcodedates.html">永久链接</a>;源文:
<a href="/pyblosxom/techic/PyBlosxom/plugins/hardcodedates.rdf">rdf</a>
,<a href="/pyblosxom/techic/PyBlosxom/plugins/hardcodedates.atom">rss</a>
,<a href="/pybnodes/techic/PyBlosxom/plugins/hardcodedates.t2t">raw</a>
| 分类: <a href="/pyblosxom/techic/PyBlosxom/plugins" title="path">/techic/PyBlosxom/plugins</a>
&sect;
<br/>
<a href="mailto:zoomquiet+blog@gmail.com?subject={PyBlosxom}hardcodedates.py&body=abt. techic/PyBlosxom/plugins/hardcodedates">[MailMe]</a>
<a href="javascript:window.print()">[Print]</a>
 <a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/cn/">
<img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/2.5/cn/80x15.png" /></a>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="E73UR2XVSP7US">
<input type="image" src="http://blog.zoomquiet.org/pybimage/icon/dollar_32.png" border="0" name="submit" alt="PayPal——最安全便捷的在线支付方式！">
<img alt="" border="0" src="https://www.paypalobjects.com/zh_XC/i/scr/pixel.gif" width="1" height="1">
</form>

<br/>
<span class="cclicence">
    &#26412;<span xmlns:dc="http://purl.org/dc/elements/1.1/" href="http://purl.org/dc/dcmitype/Text" rel="dc:type">&#20316;&#21697;</span>&#30001;<span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">Zoom.Quiet</span>&#21019;&#20316;&#65292;&#37319;&#29992;<a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/cn/">&#30693;&#35782;&#20849;&#20139;&#32626;&#21517;-&#30456;&#21516;&#26041;&#24335;&#20849;&#20139; 2.5 &#20013;&#22269;&#22823;&#38470;&#35768;&#21487;&#21327;&#35758;</a>&#36827;&#34892;&#35768;&#21487;&#12290;
&#22522;&#20110;<a xmlns:dc="http://purl.org/dc/elements/1.1/" href="/pyblosxom/techic/PyBlosxom/plugins/hardcodedates.html" rel="dc:source">zoomquiet.org</a>&#19978;&#30340;&#20316;&#21697;&#21019;&#20316;&#12290;
</span>

<br/>
<!-- for Disqus actions -->
<div id="disqus_thread"></div>
<!-- for Disqus actions -->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'zoomquietpyblosxomblogging'; // required: replace example with your forum shortname
    // The following are highly recommended additional parameters. Remove the slashes in front to use.
    var disqus_identifier = "techic/PyBlosxom/plugins/hardcodedates.html";
    var disqus_url = "http://blog.zoomquiet.org/pyblosxom/techic/PyBlosxom/plugins/hardcodedates.html";

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<!--<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
<center id="pyentrynavi">
    
</center>
-->
    </div> <!--class="meta"-->

    </div> <!-- class="text"-->

</div> <!-- id="page-content"-->
</div> <!-- class="post"-->
<hr/> 

<div class="post"> 
<div id="page-content">

    <div class="pt">
        <h1>&para; category_static.py</h1>
        <h2 class="permanentURL">
        <a href="/pyblosxom/techic/PyBlosxom/plugins/category_static.html">2010-05-31 11:10</a>
        </h2>
        <!--Mon, 31 May 2010-->
    </div>

    <div class="text">
        <div class="blosxomStory">
        <pre class="brush: python"># -*- coding: utf-8 -*-
"""
category_static.py
    - just fixed for pyblosxom-cmd  staticrender export all .html links
base index.py from:
http://snarfed.org/space/pyblosxom+index
Ryan Barrett <pyblosxom@ryanb.org>
    - Zoom.Quiet 100401

This plugin displays an alphabetical index of all entries. It uses these
optional config variables from config.py, shown here with their defaults:

py['cindex_trigger']            = '/site-index'
py['cindex_num_columns']        = 2
py['cindex_letters_first']      = True
py['cindex_title']              = 'index'
py['cindex_use_story_template'] = True


VERSION:
0.2

TODO:
- use a template instead of hard-coded HTML

Copyright 2006 Ryan Barrett

This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.
"""


import math
import os.path
import time
from operator import itemgetter
from Pyblosxom import tools
import Pyblosxom.entries
#import re

__author__ = 'Zoom.Quiet <zoomquiet+pyb at gmail dot com>'
__version__ = '11.09.7'
__url__ = "http://blog.zoomquiet.org/pyblosxom/techic/PyBlosxom/plugins/category_static.html"
__description__ = 'Displays an Category index as Tree for all entries. in one page'
DEFAULT_ROOT = []
def verify_installation(request):
  return 1

def cb_filelist(args):
    request = args['request']
    http = request.getHttp()
    data = request.getData()
    config = request.getConfiguration()
    _baseurl = config.get("base_url", "")

    trigger = config.get('cindex_trigger', 'site-index')
    if http['PATH_INFO'] != trigger:
        return

    # get the entries
    datadir = config['datadir']
    files = tools.Walk(request, datadir)
    files.sort()

    body = '<div id="categoriselist">'
    #print files
    # sort into sections, one for each letter. the dictionary is 
    # letter => (entry name, path) where path is the relative to datadir.
    #sections = {}
    #   the entrise dictionary is 
    # path => (entry name, 0) 
    entrise = []

    entry_extensions = data['extensions'].keys()

    for file in files:
        #objEntry = entries.fileentry.FileEntry(request, file,datadir)
        #print objEntry.keys()  
        assert file.startswith(datadir)
        path, ext = os.path.splitext(file[len(datadir):])
        if ext[1:] in entry_extensions:  # strip the leading period from ext
            entry_name = os.path.basename(path)
            #sections.setdefault(entry_name[0].upper(), []).append((entry_name, path))
            entrise.append((entry_name,path,file))
    #print entrise
    #sortPaths = sorted(entrise.iteritems(), key=itemgetter(1), reverse=True)
    #print sortPaths
    #print _baseurl
    etree = {}
    """{
    "pathID":[(path.split()),"title",...]
    ,
    }
    """
    for entry in entrise:
        e = Pyblosxom.entries.fileentry.FileEntry(request, entry[2], entry[1])
        deeps = entry[1].split("/")[:-1]
        pathID = "".join(deeps)
        if pathID in etree:
            etree[pathID].append((e['title'],entry[1]))
        else:
            etree[pathID]= [tuple(deeps),(e['title'],entry[1])]
    #print etree.keys()
    root_path_list = config.get("category_root_list", DEFAULT_ROOT)
    root_entry_list = []
    for opath in root_path_list:
        #print opath
        crtRoot = []
        for k in etree.keys():
            if opath in k:
                crtRoot.append(k)
        crtRoot.sort()
        root_entry_list.append((opath,crtRoot))

    '''root_entry_list as::
    [('Zen', ['ZenChinese', 'ZenGoogle', 'Zenpythonic']), ('oss', ['oss', 'ossFreeBSD', 'ossMozillaFireFox', 'ossUbuntu']), ('opening', []), ('mind', ['mind']), ('Quiet', ['Quietliving', 'Quietnomeans']), ('utility', ['utilitySubversion', 'utilitySubversionhooks', 'utilitypy4strStructuredText', 'utilitypy4webDjango', 'utilitypy4webMoinMoin', 'utilitypy4webQuixote', 'utilitypy4zh', 'utilityzqlib']), ('internet', ['internet', 'internetFolksonomy']), ('easy', ['easymovie', 'easymusic']), ('techic', ['techic', 'techicEmacs', 'techicPyBlosxom', 'techicPyBlosxomblosxom', 'techicPyBlosxomplugins'])]
    '''
    body += '<h3>/</h3>'
    for e in etree[''][1:]:
        #print "etree[''] include::",e
        body += '<span class="indents">%s</span><a href="%s%s.html">%s</a><br>\n'%(
            "...."
            ,_baseurl
            ,e[1]
            ,e[0]
            )
    #print root_entry_list

    for k in root_entry_list:
        #['techic', 'techicEmacs', 'techicPyBlosxom', 'techicPyBlosxomblosxom', 'techicPyBlosxomplugins']
        body += '<h4>%s/</h4>'%k[0]
        cpath = ""
        for p in k[1]:
            #print etree[p]
            #[('', 'Zen', 'Chinese'), '9.18', 'CC Salon BJ', '\xe2\x80\x9c\xe5\x9b\xbd\xe9\x99\x85\xe8\x87\xaa\xe7\x94\xb1\xe8\xbd\xaf\xe4\xbb\xb6\xe6\x97\xa5\xe2\x80\x9d\xe4\xb9\x8b\xe5\xa4\xb4\xe8\x84\x91\xe9\xa3\x8e\xe6\x9a\xb4', '\xe8\xa1\xa8\xe5\xbd\xa2\xe7\xa0\x81\xe7\x9a\x84\xe6\xb6\x88\xe4\xba\xa1\xe8\x83\x8c\xe6\x99\xaf\xef\xbc\x81']
            epath = "/".join(etree[p][0][2:])
            if k[0] != "".join(etree[p][0]):
                if cpath != epath:
                    cpath = epath
                    ldeep = len(etree[p][0][1:])
                    if 3 > ldeep:
                        body += '<H5>%s/</H5>'%"/".join(etree[p][0][2:])
                    else:
                        body += '<H6>%s/</H6>'%"/".join(etree[p][0][3:])
            for e in etree[p][1:]:
                body += '<span id="%s" class="indents">%s</span><a href="%s%s.html">%s</a><br>\n'%(
                        "/".join(etree[p][0])
                        ,"..."*len(etree[p][0])
                        ,_baseurl
                        ,e[1]
                        ,e[0]
                        )

    '''
    [('', 'easy', 'movie'), '\xe4\xb8\x96\xe9\x97\xb4\xe5\xae\x89\xe5\xbe\x97\xe5\x8f\x8c\xe5\x85\xa8\xe6\xb3\x95,\xe4\xb8\x8d\xe8\xb4\x9f\xe5\xa6\x82\xe6\x9d\xa5\xe4\xb8\x8d\xe8\xb4\x9f\xe5\x8d\xbf!']
    [('', 'easy', 'music'), 'ZARD\xe6\xb6\x88\xe9\x80\x9d\xe4\xba\x86']

    for entry in entrise:
        e = Pyblosxom.entries.fileentry.FileEntry(request, entry[2], entry[1])
        #print e['title']
        #print entry[1].split("/")[:-1]
        body += '<span class="indents">%s</span><a href="%s%s.html">%s</a>%s<br>\n'%(
                "...."*len(entry[1].split("/"))
                ,_baseurl
                ,entry[1]
                ,e['title'] #entry[0]
                ,entry[1]
                )
    '''
    #print body
    body +="</div>" 
    data = {'title': config.get('cindex_title', 'index')}
    # use the epoch for mtime. otherwise, pyblosxom uses the current time, which
    # makes other plugins (like weblogsping) think this is a new entry.
    epoch = time.localtime(0)
    fe = Pyblosxom.entries.base.generate_entry(request, data, body, epoch)
    return [fe]

def cb_story(args):
  request = args['request']
  http = request.getHttp()
  config = request.getConfiguration()
  trigger = config.get('cindex_trigger', 'site-index')

  if (http['PATH_INFO'] == trigger and
      not config.get('cindex_use_story_template', 1)):
    title = config.get('cindex_title', 'index')
    args['template'] = '<h1 class="index">%s</h1>\n<hr />\n$body' % title

  return args
</pre>
        </div>

<br/>
        <div class="meta"> &sect; 
写于: Mon, 31 May 2010 | <a href="/pyblosxom/techic/PyBlosxom/plugins/category_static.html">永久链接</a>;源文:
<a href="/pyblosxom/techic/PyBlosxom/plugins/category_static.rdf">rdf</a>
,<a href="/pyblosxom/techic/PyBlosxom/plugins/category_static.atom">rss</a>
,<a href="/pybnodes/techic/PyBlosxom/plugins/category_static.t2t">raw</a>
| 分类: <a href="/pyblosxom/techic/PyBlosxom/plugins" title="path">/techic/PyBlosxom/plugins</a>
&sect;
<br/>
<a href="mailto:zoomquiet+blog@gmail.com?subject={PyBlosxom}category_static.py&body=abt. techic/PyBlosxom/plugins/category_static">[MailMe]</a>
<a href="javascript:window.print()">[Print]</a>
 <a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/cn/">
<img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/2.5/cn/80x15.png" /></a>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="E73UR2XVSP7US">
<input type="image" src="http://blog.zoomquiet.org/pybimage/icon/dollar_32.png" border="0" name="submit" alt="PayPal——最安全便捷的在线支付方式！">
<img alt="" border="0" src="https://www.paypalobjects.com/zh_XC/i/scr/pixel.gif" width="1" height="1">
</form>

<br/>
<span class="cclicence">
    &#26412;<span xmlns:dc="http://purl.org/dc/elements/1.1/" href="http://purl.org/dc/dcmitype/Text" rel="dc:type">&#20316;&#21697;</span>&#30001;<span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">Zoom.Quiet</span>&#21019;&#20316;&#65292;&#37319;&#29992;<a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/cn/">&#30693;&#35782;&#20849;&#20139;&#32626;&#21517;-&#30456;&#21516;&#26041;&#24335;&#20849;&#20139; 2.5 &#20013;&#22269;&#22823;&#38470;&#35768;&#21487;&#21327;&#35758;</a>&#36827;&#34892;&#35768;&#21487;&#12290;
&#22522;&#20110;<a xmlns:dc="http://purl.org/dc/elements/1.1/" href="/pyblosxom/techic/PyBlosxom/plugins/category_static.html" rel="dc:source">zoomquiet.org</a>&#19978;&#30340;&#20316;&#21697;&#21019;&#20316;&#12290;
</span>

<br/>
<!-- for Disqus actions -->
<div id="disqus_thread"></div>
<!-- for Disqus actions -->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'zoomquietpyblosxomblogging'; // required: replace example with your forum shortname
    // The following are highly recommended additional parameters. Remove the slashes in front to use.
    var disqus_identifier = "techic/PyBlosxom/plugins/category_static.html";
    var disqus_url = "http://blog.zoomquiet.org/pyblosxom/techic/PyBlosxom/plugins/category_static.html";

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<!--<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
<center id="pyentrynavi">
    
</center>
-->
    </div> <!--class="meta"-->

    </div> <!-- class="text"-->

</div> <!-- id="page-content"-->
</div> <!-- class="post"-->
<hr/> 

<!--<h2>Thu, 13 May 2010</h2>-->
<!--for firstdaydiv.py 
    <span class="blosxomDate">Thu, 13 May 2010</span>
-->
<div class="post"> 
<div id="page-content">

    <div class="pt">
        <h1>&para; IOP:实践之一</h1>
        <h2 class="permanentURL">
        <a href="/pyblosxom/Zen/IOP/iop-how2-tenfold-speed-py-script-2010-05-13-19-19.html">2010-05-13 19:19</a>
        </h2>
        <!--Thu, 13 May 2010-->
    </div>

    <div class="text">
        <div class="blosxomStory">
        <div class="header" id="header">
<a name='toptopSkZIVkFPW' id='toptopSkZIVkFPW'></a><h1>IOP:实践之一</h1>
<h2>~ 如何令Python脚本提速100倍?!</h2>
</div>

<div class="toc" id="toc">
  <ol>
  <li><a href="#toc1R0VYQ0IyR">背景</a>
    <ul>
    <li><a href="#toc2R0VYRENMU">1.1. 预案</a>
    </li>
    </ul>
  </li>
  <li><a href="#toc3R0lYQ0FTS">IOP的加速技巧</a>
    <ul>
    <li><a href="#toc4R0lYRENMU">2.1. 10万:170+4秒</a>
      <ul>
      <li><a href="#toc5R0lYRENMU">2.1.1. code</a>
      </li>
      <li><a href="#toc6R0lYRENMU">2.1.2. speed</a>
      </li>
      <li><a href="#toc7R0lYRENMU">2.1.3. improve</a>
      </li>
      </ul>
    </li>
    <li><a href="#toc8R0lYREVMU">2.2. 10万:150+10秒</a>
      <ul>
      <li><a href="#toc9R0lYREVMU">2.2.1. thinking</a>
      </li>
      <li><a href="#toc10R0lYREVMU">2.2.2. code</a>
      </li>
      <li><a href="#toc11R0lYREVMU">2.2.3. improve</a>
      </li>
      </ul>
    </li>
    <li><a href="#toc12R0lYREdMU">2.3. 10万:100+200秒?!</a>
      <ul>
      <li><a href="#toc13R0lYREdMU">2.3.1. thinking</a>
      </li>
      <li><a href="#toc14R0lYREdMU">2.3.2. code</a>
      </li>
      <li><a href="#toc15R0lYREdMU">2.3.3. speed</a>
      </li>
      <li><a href="#toc16R0lYREdMU">2.3.4. improve</a>
      </li>
      </ul>
    </li>
    <li><a href="#toc17R0lYRElMU">2.4. 1000万:1100秒+480秒</a>
      <ul>
      <li><a href="#toc18R0lYRElMU">2.4.1. thinking</a>
      </li>
      <li><a href="#toc19R0lYRElMU">2.4.2. code</a>
      </li>
      <li><a href="#toc20R0lYRElMU">2.4.3. improve</a>
      </li>
      </ul>
    </li>
    <li><a href="#toc21R0lYREtMU">2.5. 小记</a>
    </li>
    </ul>
  </li>
  <li><a href="#toc22R01YQ0JaV">提速100倍</a>
  </li>
  </ol>

</div>
<div class="body" id="body">
<a id="toc1R0VYQ0IyR" name="toc1R0VYQ0IyR"></a>
<h1><A href='#toptopSkZIVkFPW'> 1. 背景 </A></h1>
<p>
什么事儿呢?
</p>
<ul>
<li>在一高压力服务环境中,需要加速系统的响应
</li>
<li>现行系统对于数据查询要尝试三种数据库源:
 <ol>
 <li>memcache
 </li>
 <li>redis
 </li>
 <li>MySQL
 </li>
 </ol>
</li>
<li>期望查询加速至少 300%
</li>
</ul>

<dl>
<dt>运行环境</dt><dd>
<pre>
客户机:
    - 俺的Laptop HP 520
    - 双核CPU 2G内存
    - Ubuntu 9.10
DB主机:
    - CentOS 5.0
    - 单核CPU 4G 内存
</pre>
</dd>
</dl>

<a id="toc2R0VYRENMU" name="toc2R0VYRENMU"></a>
<h2><A href='#toptopSkZIVkFPW'> 1.1. 预案 </A></h2>
<p>
这事儿,一想,简单哪,都放内存就好的哪
</p>
<ul>
<li>统计了一下需要用来查询的数据不到2千万条
</li>
<li>折算成文件不过1G
</li>
<li>加载到内存中,使用 Python 字典结构的话,也最多涨一倍,也完全可以接受
</li>
<li>速度?!
 <ul>
 <li><a href="http://yongsun.me/2007/11/python-rbtree%e5%92%8c%e5%86%85%e5%bb%badict%e7%9a%84%e6%80%a7%e8%83%bd%e6%af%94%e8%be%83/">python-rbtree和内建dict的性能比较</a>
 </li>
 <li>那绝对不是问题!
 </li>
 </ul>
</li>
</ul>

<a id="toc3R0lYQ0FTS" name="toc3R0lYQ0FTS"></a>
<h1><A href='#toptopSkZIVkFPW'> 2. IOP的加速技巧 </A></h1>
<p>
<code>没有想到,加速,只要不断将代码住短里面写就好!</code>
</p>
<p>
不知道什么是 IOP?
</p>
<ul>
<li><a href="http://wiki.woodpecker.org.cn/moin/PyIOP">PyIOP</a>
</li>
<li>咔咔咔,沈游侠总结的编程态度&gt;...
</li>
</ul>

<a id="toc4R0lYRENMU" name="toc4R0lYRENMU"></a>
<h2><A href='#toptopSkZIVkFPW'> 2.1. 10万:170+4秒 </A></h2>
<dl>
<dt>最直接的实现</dt><dd>
</dd>
</dl>

<ul>
<li>从redis 读
</li>
<li>生成 dict 对象
</li>
<li>以pickle dump 出序列化文件
</li>
<li>用pickle load 加载成dict对象
</li>
</ul>

<a id="toc5R0lYRENMU" name="toc5R0lYRENMU"></a>
<h3><A href='#toptopSkZIVkFPW'> 2.1.1. code </A></h3>
<dl>
<dt>代码:</dt><dd>
<p></p>
<pre class="brush:  python">

#!/usr/bin/python 
# -*- coding: utf-8 -*-
import struct,sys,time
import cPickle as pickle
import redis
REVERSION = "r2d.py v10.5.7"
def _push2dict(dictall,key,smembers):
    dictall[struct.pack('I',int(key[1:]))]=[s.split("|") for s in rb.smembers(k)]    
    return dictall
if __name__ == '__main__':      # this way the module can be
    if 3 != len(sys.argv):
        print """ %s usage::
$ python r2d.py redistIP limitnumber [like 10000]
        """ % REVERSION
    else:
        hostIP = sys.argv[1]
        limitn = sys.argv[2]
        rb = redis.Redis(host=hostIP, port=6379, db=9)
        rbkeys = rb.keys().split()
        loop = int(limitn)
        s4dict={}
        for k in rbkeys:
            if 0 == loop:
                break
            else:
                loop -=1
                _push2dict(s4dict,k,rb.smembers(k))
        pickle.dump(s4dict, open('r4d.dump', 'wb'))
</pre>
</dd>
</dl>

<a id="toc6R0lYRENMU" name="toc6R0lYRENMU"></a>
<h3><A href='#toptopSkZIVkFPW'> 2.1.2. speed </A></h3>
<ul>
<li>代码足够简单了,单函式,20行
</li>
<li>速度测试::
 <ul>
 <li>10W 值对导出 &gt;170秒,导入&gt;4秒;
 </li>
 <li>100W 值对导出 &gt;500秒,导入&gt;25秒;
 </li>
 <li>1000W 值对导出 <b>失败! 内存提前耗光!</b>
 </li>
 </ul>
</li>
</ul>

<a id="toc7R0lYRENMU" name="toc7R0lYRENMU"></a>
<h3><A href='#toptopSkZIVkFPW'> 2.1.3. improve </A></h3>
<p>
这完全无法接受哪...
</p>
<dl>
<dt>加速尝试::</dt><dd>
</dd>
</dl>

<ol>
<li>根据 IOP 尽量不用函式,将那个一行函式清除,代码填回循环 ~ <i>立即获得几秒的加速</i>
</li>
<li>本来用的就是cPickle 了,模块效率没有办法了
</li>
<li>嗯嗯嗯,可以不用 cPickle卟?
 <ul>
 <li>直接输出自然 .py 哈?!
 </li>
 </ul>
</li>
</ol>

<pre class="brush:  python">


# 使用 str() 将字典对象用文本的方式记入 .py 
vdf = open("r2d.define.py","wa")
vdf.write("s4dict=")
vdf.write(str(s4dict))
vdf.close()
# 使用时直接 import 就好

</pre>
<p></p>
<ul>
<li>改进后测试::
 <ul>
 <li>10W 值对导出 &gt;160秒,导入&gt;3秒;
 </li>
 <li>100W 值对导出 &gt;400秒,导入&gt;19秒;
 </li>
 <li>1000W 值对导出 <b>依然杯具</b>
 </li>
 </ul>
</li>
<li>加速不明显:
 <ul>
 <li>导出时速度变化很小
 </li>
 <li>载入时速度有提升
 </li>
 </ul>
</li>
<li>进一步观察到,导出时内存飞速增长:
 <ul>
 <li>100W级别,要食掉1.6G左右的内存
 </li>
 <li>redis 本身也很占内存,千万级别时,也要占上G (当然这和条目数量/内容有关)
 </li>
 <li>这对于服务器是个不可接受的方式
 </li>
 </ul>
</li>
</ul>

<a id="toc8R0lYREVMU" name="toc8R0lYREVMU"></a>
<h2><A href='#toptopSkZIVkFPW'> 2.2. 10万:150+10秒 </A></h2>
<dl>
<dt>改进中间数据格式:</dt><dd>
</dd>
</dl>

<ul>
<li>从redis 读
</li>
<li>生成 中间log文件
</li>
<li>导入成 字典对象
</li>
</ul>

<a id="toc9R0lYREVMU" name="toc9R0lYREVMU"></a>
<h3><A href='#toptopSkZIVkFPW'> 2.2.1. thinking </A></h3>
<p>
因为有这些现实:
</p>
<ol>
<li>想输出不论 pickle 或是 .py 的字典对象,都得先在内存中构造出这一对象
</li>
<li>随着字典对象的规模增加,必然导致这一构建过程的时间加长
</li>
</ol>

<p>
经沈游侠提醒,发现字典对象其实是可以线性输出的:
</p>
<ul>
<li>比如说,字典结构如:
<pre>
{key:[(v1,v2,v3),..]
,...
}
</pre>
 <ul>
 <li><code>K:[list]</code> 形式的两层结构
 </li>
 </ul>
</li>
<li>那么,就可以通过中间数据文本:
<pre>
('key', [(v1, 'v2', v3)])
...
</pre>
</li>
<li>进行线性加载,e.g:
<pre class="brush:  python">

for l in open("r2d.define.py.log","r").readlines():
    dd = eval(l)
    if dd[0] in s4d:
        s4d[dd[0]].append((dd[1],dd[2],dd[3]))
    else:
        s4d[dd[0]]=[(dd[1],dd[2],dd[3])]

</pre>
</li>
</ul>

<a id="toc10R0lYREVMU" name="toc10R0lYREVMU"></a>
<h3><A href='#toptopSkZIVkFPW'> 2.2.2. code </A></h3>
<p>
快速修订对应行动代码:
</p>
<pre class="brush:  python">

#!/usr/bin/python 
# -*- coding: utf-8 -*-
import struct,sys,time
import redis
REVERSION = "r2d.py v10.5.8"
if __name__ == '__main__':      # this way the module can be
    if 3 != len(sys.argv):
        print """ %s usage::
$ python r2d.py redistIP limitnumber [like 10000] &gt; mid-data.log
        """ % REVERSION
    else:
        hostIP = sys.argv[1]
        limitn = sys.argv[2]
        rb = redis.Redis(host=hostIP, port=6379, db=9)
        rbkeys = rb.keys().split()
        loop = int(limitn)
        for k in rbkeys:
            if 0 == loop:
                break
            else:
                loop -=1
                dictkey = struct.pack('I',int(k[1:]))
                sli = []
                for s in rb.smembers(k):
                    rli = s.split("|")[:3]
                    if rli:
                        rli[0] = int(rli[0])
                        rli[1] = struct.pack('I',int(rli[1]))
                        rli[2] = int(rli[2])
                        sli.append(tuple(rli))
                print &gt;&gt; d2f,`dictkey,sli`
                #注意: `obj` 等同 repr(obj)  
</pre>
<p></p>
<a id="toc11R0lYREVMU" name="toc11R0lYREVMU"></a>
<h3><A href='#toptopSkZIVkFPW'> 2.2.3. improve </A></h3>
<p>
代码依然简单了,无函式,30行
</p>
<ul>
<li>速度测试::
 <ul>
 <li>10W 值对导出 &gt;150秒,导入&gt;10秒;
 </li>
 <li>100W 值对导出 &gt;500秒,导入&gt;20秒;
 </li>
 <li>1000W 值对导出 &gt;1300秒,导入&gt;90秒;
 </li>
 </ul>
</li>
<li>速度看起来没有什么明显的提高
</li>
<li><b>不过!</b>
 <ol>
 <li>千万级别的数据可以在低配置环境中跑完了!
 </li>
 <li>内存占用很稳定永远90M左右,不会随字典对象的增长而增长!
 </li>
 </ol>
</li>
</ul>

<p>
嗯嗯嗯,这算是可用了...
</p>
<a id="toc12R0lYREdMU" name="toc12R0lYREdMU"></a>
<h2><A href='#toptopSkZIVkFPW'> 2.3. 10万:100+200秒?! </A></h2>
<dl>
<dt>继续改进:</dt><dd>
</dd>
</dl>

<ul>
<li>放弃 redis 直接从MySQL 读
</li>
<li>生成 中间日志
</li>
<li>导入成 dict 文件
</li>
</ul>

<a id="toc13R0lYREdMU" name="toc13R0lYREdMU"></a>
<h3><A href='#toptopSkZIVkFPW'> 2.3.1. thinking </A></h3>
<p>
虽然redis 是号称最快的 K/V 数据库产品，但是，明显就是它将整个业务响应速度拖慢了..
</p>
<dl>
<dt>为什么呢？</dt><dd>
</dd>
</dl>

<ul>
<li>服务器程序和本地程序面对的环境是不同的
</li>
<li>高压力服务器程序和小压力服务器程序也是不同的
</li>
<li>简单来说:
 <ol>
 <li>小型服务~=每秒&lt;C60
 </li>
 <li>中型服务~=每秒&lt;C600
 </li>
 <li>大型服务~=每秒&gt;C1000
 </li>
 </ol>
</li>
<li>面对的矛盾是完全不同的:
 <ol>
 <li>小型服务-&gt;语言执行效率
 </li>
 <li>中型服务-&gt;框架执行效率
 </li>
 <li>大型服务-&gt;I/O 响应速度
 </li>
 </ol>
</li>
<li>所以，对于面向Web 的查询服务，不论 Redis/MySQL 对于业务系统，都是进程间通讯!
</li>
<li>每次跨进程通讯，都意味着至少四次I/O操作！
</li>
<li>所以，当前 Redis-&gt;log-&gt;内存字典的转换流程，其实包含了 MySQL-&gt;Redis 的进程操作
</li>
<li>另外:
 <ul>
 <li>遍查 Redis 文档，居然没有 <code>iterkeys()</code> 类似的操作！
 </li>
 <li>每次不论转换多少 Redis 的值对，都得使用<code>keys()</code> 将键先取出来然后再逐一匹配处理
 </li>
 <li>怪不得使用 Redis 测试用小仓库(包含20万值对)时，脚本运行速度和使用全数据Redis(千万值对)时速度要相差5倍以上！内存也占用多几倍!
 </li>
 </ul>
</li>
</ul>

<p>
<b>所以!要直接从 MySQL 相关表中读取</b>
</p>
<a id="toc14R0lYREdMU" name="toc14R0lYREdMU"></a>
<h3><A href='#toptopSkZIVkFPW'> 2.3.2. code </A></h3>
<p>
配合一SQL 模板:
</p>
<pre class="brush:  sql">

-- _tpl/all_black.tpl
SELECT v1,v2,v3,v4,id FROM t_black LIMIT %(limitMAX)s;
</pre>
<p></p>
<p>
核心代码:
</p>
<pre class="brush:  python">

#!/usr/bin/python 
# -*- coding: utf-8 -*-
REVERSION = "m2d.py v10.5.9"
import struct,sys,time

if __name__ == '__main__':      # this way the module can be
    """usage:
$ python m2d.py limit [such as 100] |\
  mysql -h xx.xx.xx.xx -u User -D --password=***  |\
  python m2d.py &gt; m2d.log
    """
    if sys.stdin:
        if 1 &lt; len(sys.argv):
            limit = sys.argv[1]
            limitMAX = int(limit)
            print &gt;&gt; sys.stderr, info
            print open("_tpl/all_black.tpl","r").read()%locals()
        else:
            s4dict={}
            virusname={}
            totalN = 0
            for l in sys.stdin.readlines():
                if "id" in l:
                    pass
                else:
                    totalN += 1
                    lkv=l.split()
                    dictkey = struct.pack('I',int(lkv[0]))
                    lkv[1] = int(lkv[1])
                    lkv[2] = struct.pack('I',int(lkv[2]))
                    lkv[3] = int(lkv[3])
                    print &gt;&gt; d2f,`dictkey,tuple(lkv[1:])`
</pre>
 <ul>
 <li>用是否有额外参数来判定是否生成SQL,还是进行MySQL 的输出数据处理
 </li>
 <li>为了不影响标准输出,调试信息,输出到标准错误IO
 </li>
 <li>调试也应该根据管道串的层级,一级级运行尝试
 </li>
 <li>调用的shell:
<pre class="brush:  shell">

#!/bin/sh
#   m2d.sh v10.5.9
python m2d.py go |\
    mysql -h xx.xx.xx.xx -u User --password=***|\
    python mysql4dict.py $1 |\
    mysql -h xx.xx.xx.xx -u User --password=***|\
    python m2d.py &gt; m2d.log
</pre>
 <p></p>
<b>加载时代码没有怎么变</b>
 </li>
 </ul>

<a id="toc15R0lYREdMU" name="toc15R0lYREdMU"></a>
<h3><A href='#toptopSkZIVkFPW'> 2.3.3. speed </A></h3>
<ul>
<li>速度测试::
 <ul>
 <li>0.1W 值对导出 &lt;5秒,导入&lt;1秒;
 </li>
 <li>10W 值对导出 &gt;300秒,导入&gt;10秒;
 </li>
 <li>100W 值对导出 杯具鸟
 </li>
 <li>1000W 值对导出 杯具鸟
 </li>
 </ul>
</li>
<li>速度怎么和查询的条目多少有关? 而且一大MySQL 就拒绝服务?
</li>
</ul>

<a id="toc16R0lYREdMU" name="toc16R0lYREdMU"></a>
<h3><A href='#toptopSkZIVkFPW'> 2.3.4. improve </A></h3>
<p>
嗯嗯嗯,FT! 当然了,MySQL 请求响应时间是有限制的,大数据传输肯定是有问题的,
利用 <code>LIMIT</code> 的切片!
</p>
<ul>
<li>改造前述<code>m2d.py v10.5.9</code> SQL生成部分的代码:
<pre class="brush:  python">

step = 5000.0
limitMAX = int(limit)
sqltpl = open("_tpl/all_black.tpl","r").read()
if 1 &gt;= limitMAXb/step:
    print sqltpl%locals()
else:
    for i in range(int(limitMAX/step)):
        limitMAX = "%d,%d"%(step*i,int(step))
        print sqltpl%locals()
</pre>
</li>
<li>以 5000 为界限,生成类似 <code>LIMIT 15000,5000</code> 的限制
</li>
</ul>

<ul>
<li>速度测试::
 <ul>
 <li>100W 值对导出 &gt;290秒,导入&gt;190秒;
 </li>
 <li>1000W 值对导出 杯具鸟
 </li>
 </ul>
</li>
</ul>

<p>
<b>FT!怎么回事儿?速度意外的慢!</b>
</p>
<a id="toc17R0lYRElMU" name="toc17R0lYRElMU"></a>
<h2><A href='#toptopSkZIVkFPW'> 2.4. 1000万:1100秒+480秒 </A></h2>
<dl>
<dt>冷静后改进:</dt><dd>
</dd>
</dl>

<ul>
<li>从MySQL 读使用id 进行限制切分
</li>
<li>生成 中间日志,但是重新设计结构
</li>
<li>导入成 dict 文件
</li>
</ul>

<a id="toc18R0lYRElMU" name="toc18R0lYRElMU"></a>
<h3><A href='#toptopSkZIVkFPW'> 2.4.1. thinking </A></h3>
<dl>
<dt>MySQL 为什么这么慢?!</dt><dd>
</dd>
</dl>

<ul>
<li>嗯嗯嗯,N久没有使用过DB,这次重温了为什么远离DB的恶体验
</li>
<li>MySQL 本身就不是千万级别的产品,虽然有很多招可以应对
 <ul>
 <li><a href="http://www.cnblogs.com/fjytzh/archive/2010/04/02/1702886.html">mysql limit查询优化（数据量大的时候很优）</a>
 </li>
 <li><a href="http://grb12508.blog.163.com/blog/static/273784582009102448061/">Mysql limit 优化，百万至千万级快速分页</a>
 </li>
 </ul>
</li>
<li>不过,以上招都不好使,咨询了一下同事,直接使用ID范畴来限定就好!
</li>
</ul>

<a id="toc19R0lYRElMU" name="toc19R0lYRElMU"></a>
<h3><A href='#toptopSkZIVkFPW'> 2.4.2. code </A></h3>
<p>
SQL 模板配合改进:
</p>
<pre class="brush:  sql">

-- _tpl/all_black.tpl
SELECT v1,v2,v3,v4,id FROM t_black WHERE id&gt;%(LIMbwID)s AND id&lt;=%(MAXbwID)s;
</pre>
<p></p>
<p>
SQL 生成代码:
</p>
<pre class="brush:  python">

step = 3000.0
offset = int(step)
# &lt; &lt;gen_sql_with_max&gt; &gt; 使用Leo 时可以定义子节点将成堆代码变成语义标记
for l in sys.stdin.readlines():
    if "max(id)" not in l:
        amount = l.split()
        MAXbwID = int(amount[0]
        MINbwID = int(amount[1]
        MAXbwA = MAXbID-MINbID
MAXbMAX = MAXbwID
lastID = 0
sqltpl = open("_tpl/all_black.tpl","r").read()
for i in range(MAXbwA/offset):
    MAXbwID,LIMbwID = (MAXbMAX-offset*i,MAXbMAX-offset*(i+1))
    print sqltpl%locals()
    lastID = LIMbID
MAXbID,LIMbID = lastID,MINbID   # 将切片限数之内的尾数个ID也查询出来
print sqltpl%locals()
</pre>
<ul>
<li>咔咔咔,当然的,要进行基于ID 的精确切分选择,就得先知道最大和最小的ID
</li>
<li>使用SQL <code>SELECT max(id),min(id) FROM t_black ;</code>
</li>
<li>自然运用系统管道串接成处理过程:
<pre class="brush:  shell">

#!/bin/sh
#   m2d.sh v10.5.9
DATE=`date "+%y%m%d-%H%M%S"`
mysql -h xx.xx.xx -u User --password=*** &lt; _tpl/total_black.sql |\
    python m2d.py go |\
    mysql -h xx.xx.xx -u User --password=*** |\
    python m2d.py &gt; m2d_$DATE.log
</pre>
</li>
</ul>

<a id="toc20R0lYRElMU" name="toc20R0lYRElMU"></a>
<h3><A href='#toptopSkZIVkFPW'> 2.4.3. improve </A></h3>
<ul>
<li>速度测试::
 <ul>
 <li>100W 值对导出 &gt;280秒,导入&gt;120秒;
  <ul>
  <li>m2d.log &gt; 150M
  </li>
  </ul>
 </li>
 <li>1000W 值对导出 &gt;1300秒,导入&gt;780秒;
  <ul>
  <li>m2d.log &gt; 570M
  </li>
  </ul>
 </li>
 </ul>
</li>
</ul>

<p>
进一步的,发现业务其实可以将双层,两次查询优化成一次查询的!
</p>
<ul>
<li>简单的将输出字典的数据结构变成:
<pre>
{key:v,...
}
</pre>
</li>
<li>将原先的2个值结合原先的key 变成键,就成为了全局唯一的key
</li>
<li>即和MySQL 每行数据完成一一对应
</li>
<li>速度再测试::
 <ul>
 <li>100W 值对导出 &gt;250秒,导入&gt;100秒;
  <ul>
  <li>m2d.log &gt; 130M
  </li>
  </ul>
 </li>
 <li>1000W 值对导出 &gt;1100秒,导入&gt;480秒;
  <ul>
  <li>m2d.log &gt; 490M
  </li>
  </ul>
 </li>
 </ul>
</li>
<li>哗! 而且加载完后,字典对象所点内存体积也同样减少了 30% !
</li>
</ul>

<a id="toc21R0lYREtMU" name="toc21R0lYREtMU"></a>
<h2><A href='#toptopSkZIVkFPW'> 2.5. 小记 </A></h2>
<dl>
<dt>综上:</dt><dd>
</dd>
</dl>

<ul>
<li>应用 IOP 方面的主要招术:
 <ol>
 <li>表用 函式
 </li>
 <li>表用 模块
 </li>
 <li>尽量使用 OS 的标准 I/O 进行功能串接
 </li>
 </ol>
</li>
<li><b>DOP</b>~<code>Data Oriented Programming</code>
 <ul>
 <li>面向数据编程
 </li>
 <li>归根到底,程序都得操作数据解决问题
 </li>
 <li>服务器端,大并发压力时,最有效的节省I/O 的方式,就是高效方式
 </li>
 <li>压缩输入/出的数据量自然是最好的代码!
 </li>
 </ul>
</li>
</ul>

<a id="toc22R01YQ0JaV" name="toc22R01YQ0JaV"></a>
<h1><A href='#toptopSkZIVkFPW'> 3. 提速100倍 </A></h1>
<p>
嗯嗯嗯？！怎么说到最后好象也没有加速到100倍哪？
</p>
<ul>
<li>是也乎，是也乎，以上分享的是内存化字典数据的转换脚本加速过程
</li>
<li>但是最后要加速的是整个查询业务哈?
</li>
<li>因为涉及公司核心服务,代码就无法展示了
</li>
<li>不过,现实是:
 <ol>
 <li>使用了以上 IOP 中提及的基础技巧
 </li>
 <li>每查询业务的处理时间从原先的 0.* 秒,加速到 0.00*秒,至少100倍
 </li>
 <li>而对应的代码从 几千行,精简到几十行
 </li>
 </ol>
</li>
</ul>

<p>
所以,基本上可以这么理解:
</p>
<ul>
<li>将代码每<b>精简一倍体积</b>
</li>
<li>运行速度就有望<b>提高10倍</b>
<p></p>
不相信? 尝试一哈噻...
</li>
</ul>

<hr class="light" />
<ul>
<li>t2t渲染:: 2010-10-09 02:21:36
</li>
<li>动力源自::<b><a href="http://txt2tags.sf.net">txt2tags</a></b>
</li>
</ul>

</div>

<!-- xhtml code generated by txt2tags 2.4 (http://txt2tags.sf.net) -->
<!-- cmdline: txt2tags ./Zen/IOP/iop-how2-tenfold-speed-py-script-2010-05-13-19-19.t2t -->

        </div>

<br/>
        <div class="meta"> &sect; 
写于: Thu, 13 May 2010 | <a href="/pyblosxom/Zen/IOP/iop-how2-tenfold-speed-py-script-2010-05-13-19-19.html">永久链接</a>;源文:
<a href="/pyblosxom/Zen/IOP/iop-how2-tenfold-speed-py-script-2010-05-13-19-19.rdf">rdf</a>
,<a href="/pyblosxom/Zen/IOP/iop-how2-tenfold-speed-py-script-2010-05-13-19-19.atom">rss</a>
,<a href="/pybnodes/Zen/IOP/iop-how2-tenfold-speed-py-script-2010-05-13-19-19.t2t">raw</a>
| 分类: <a href="/pyblosxom/Zen/IOP" title="path">/Zen/IOP</a>
&sect;
<br/>
<a href="mailto:zoomquiet+blog@gmail.com?subject={PyBlosxom}IOP:实践之一&body=abt. Zen/IOP/iop-how2-tenfold-speed-py-script-2010-05-13-19-19">[MailMe]</a>
<a href="javascript:window.print()">[Print]</a>
 <a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/cn/">
<img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/2.5/cn/80x15.png" /></a>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="E73UR2XVSP7US">
<input type="image" src="http://blog.zoomquiet.org/pybimage/icon/dollar_32.png" border="0" name="submit" alt="PayPal——最安全便捷的在线支付方式！">
<img alt="" border="0" src="https://www.paypalobjects.com/zh_XC/i/scr/pixel.gif" width="1" height="1">
</form>

<br/>
<span class="cclicence">
    &#26412;<span xmlns:dc="http://purl.org/dc/elements/1.1/" href="http://purl.org/dc/dcmitype/Text" rel="dc:type">&#20316;&#21697;</span>&#30001;<span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">Zoom.Quiet</span>&#21019;&#20316;&#65292;&#37319;&#29992;<a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/cn/">&#30693;&#35782;&#20849;&#20139;&#32626;&#21517;-&#30456;&#21516;&#26041;&#24335;&#20849;&#20139; 2.5 &#20013;&#22269;&#22823;&#38470;&#35768;&#21487;&#21327;&#35758;</a>&#36827;&#34892;&#35768;&#21487;&#12290;
&#22522;&#20110;<a xmlns:dc="http://purl.org/dc/elements/1.1/" href="/pyblosxom/Zen/IOP/iop-how2-tenfold-speed-py-script-2010-05-13-19-19.html" rel="dc:source">zoomquiet.org</a>&#19978;&#30340;&#20316;&#21697;&#21019;&#20316;&#12290;
</span>

<br/>
<!-- for Disqus actions -->
<div id="disqus_thread"></div>
<!-- for Disqus actions -->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'zoomquietpyblosxomblogging'; // required: replace example with your forum shortname
    // The following are highly recommended additional parameters. Remove the slashes in front to use.
    var disqus_identifier = "Zen/IOP/iop-how2-tenfold-speed-py-script-2010-05-13-19-19.html";
    var disqus_url = "http://blog.zoomquiet.org/pyblosxom/Zen/IOP/iop-how2-tenfold-speed-py-script-2010-05-13-19-19.html";

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<!--<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
<center id="pyentrynavi">
    
</center>
-->
    </div> <!--class="meta"-->

    </div> <!-- class="text"-->

</div> <!-- id="page-content"-->
</div> <!-- class="post"-->
<hr/> 

</div><!-- id="content" class="g33"-->
</div><!-- id="main" class="g25"-->
</td><!-- id="main" -->
</tr>
<tr><td><!-- id="footer" -->

<div id="funcbarnner">

<!-- foot function barnners -->
    <table class="funcbarnner" align="CENTER" border="0">
    <tr><td>
        <!-- LEFT function barnners -->
        <div id="footeractions" class="sidebar">

          <!-- used in the search text box -->
          <script type="text/javascript">
          function set_if(id, if_value, set_value) {
            field = document.getElementById(id);
            if (field.value == if_value)
              field.value = set_value;
          }
          </script>
        <h3>Search</h3>
        <form class="form" method="get" action="http://www.google.com/search"
          onsubmit="new site_search('zoomquiet.org', q.value); return false;">
          <input type="hidden" name="sitesearch" value="zoomquiet.org" />
          <input type="text" size="18" name="q" id="query" value="Search" 
                onfocus="set_if('query', 'Search', '')"
                onblur="set_if('query', '', 'Search') " />
        </form>

        <script type="text/javascript"
           src="http://www.google.com.hk/uds/api?file=uds.js&v=1.0&key=ABQIAAAAlv7iO6iSrWdXLWy2P0ESwxQsUXuTv2eYBKPcreHKOEV8Fxl8CRT7Gxa-7r7kr05t4FDbQimxwYwf_w">
        </script>
        <script type="text/javascript" src="/pybshare/ajax_search.js"></script>

        <h3>abt.</h3>
        <ul id="Blogroll">

        <li>reading.
            <ul id="BlogrollSubTopic">
                <li><a href="http://techparty.org/">珠三角技术沙龙</a>
                <br/><a href="http://timyang.net/">Tim</a>
                <br/><a href="http://www.czug.org/blog/panjy/">潘俊勇</a>
                <br/><a href="http://blog.laiyonghao.com/">赖勇浩</a>
                <br/><a href="http://march-liu.blogspot.com/">刘鑫</a>
                <br/><a href="http://www.jeffkit.info/">Jeff</a>
                <br/><a href="http://blog.linluxiang.info/">林路翔</a>
                </li>
                <li><a href="http://blog.gasolin.idv.tw/">INET6</a>
                <br/><a href="http://www.feime.net/">Albertlee</a>
                </li>
                <li><a href="http://anzhu.net/feed/">安猪</a>
                <br/><a href="http://tonyyet.com/">Tony yet</a>
                </li>

            </ul><!--id="BlogrollSubTopic"-->
            </li>
        <li>sys.
            <ul id="BlogrollSubTopic">
                <li><b><a href="/pyblosxom/recent.html">recents</a></b></li>
                <li><a href="/pyblosxom/plugin_info/">plugins</a></li>

            </ul><!--id="BlogrollSubTopic"-->
            </li>

            <li>livin
                <ul id="BlogrollSubTopic">    
                <li>
        <a href="/pyblosxom/Zen/Chinese/918-2006-09-18-10-30.html"><img alt="i Chinese!" src="/pybimage/icon/china.png"/></a>
        <br/>
        <a href="http://www.google.com/talk/"><img alt="i in GTalking!" src="/pybimage/icon/gtalk.png"/></a>
        <br/>
        <a href="https://mail.google.com"><img alt="i livin GMail!" src="/pybimage/icon/gmail.png"/></a>
        <br/>
        <a href="http://zoomq.livejournal.com/"><img alt="i in livejournal.com" src="/pybimage/icon/lj.png"/></a>
        <br/>
                </li>

                <li>
        <a href="http://www.catb.org/hacker-emblem/"><img alt="happy hacking"  src="/pybimage/icon/hacker.png"/></a>
        <br/>
        <a href="http://webpages.charter.net/edreamleo/front.html"><img alt="Get LEO -- z Great Literate Programming Env."  src="/pybimage/icon/button-leo.png"/></a>
        <br/>
        <a href="http://www.spreadfirefox.com/?q=affiliates&id=0&t=85"><img alt="Get z Great FireFox!" src="/pybimage/icon/getfirefox.png"/></a>
        <br/>
        <a href="http://browsehappy.com/why/"><img alt="i hate IE!" src="/pybimage/icon/no_ie_80x15_2.png"/></a>
        <br/>
                </li>
                <li>
        <!--
        <a href="http://www.7-zip.org/"><img alt="i enjoy 7-zip" src="/pybimage/icon/7zip.png"/></a>
        <br/>
        -->        
        <a href="http://www.gimp.org/"><img alt="Get z Great GIMP!"  src="/pybimage/icon/getgimp.png"/></a>
        <br/>
        <a href="http://www.inkscape.org/"><img alt="Get z Great Inkscape!"  src="/pybimage/icon/getinkscape.png"/></a>
        <br/>
        <a href="http://www.openoffice.org/"><img alt="Get z Great OOo!"  src="/pybimage/icon/ooo.png"/></a>
        <br/>
                </li>
                <li>
        <a href="http://www.onlineghibli.com/"><img alt="i watch GHIBLI mov." src="/pybimage/icon/ghibli.png"/></a>
        <br/>   
        <a href="http://www.thematrix101.com/"><img alt="i watch The Matrix" src="/pybimage/icon/martix.png"/></a>
        <!--<br/>   
        <a href="http://www.fifthelement.com/"><img alt="i watch 第五元素" src="/pybimage/icon/fifthelemen.png"/></a>
        -->
        <br/>   
        <a href="http://www.xfiles.com/"><img alt="i watch X-FILES" src="/pybimage/icon/xfiles.png"/></a>
        <br/>   
        <a href="http://www.startrek.com/startrek/view/series/ENT/"><img alt="i watch StarTrek" src="/pybimage/icon/tng.png"/></a>
        <br/>   
        <a href="http://www.syfy.com/battlestar/"><img alt="i watch Battlestar Galactica" src="/pybimage/icon/galactica.png"/></a>
        <br/>   
                </li>
                <li>
        <a href="http://www.douban.com/group/rock/"><img alt="i listen ROCK!" src="/pybimage/icon/rock.png"/></a>
        <br/>
                </li>
                </ul><!--id="BlogrollSubTopic"-->  
            </li><!-- livin -->
            <li>powered
                <ul id="BlogrollSubTopic">
                <li>
        <a href="http://txt2tags.sourceforge.net"><img  alt="Get z Great t2t!" src="/pybimage/icon/t2tpowered-white.png"/></a>
        <br/>
        <a href="http://wacom.com.cn"><img alt="i usage WACOM replace mouse" src="/pybimage/icon/wacom.png"/></a>
        <br/>
        <a href="http://www.w3.org/TR/xhtml1/"><img alt="i export XHTML" src="/pybimage/icon/xhtml.png"/></a>
        <br/>
        <a href="http://www.w3.org/Style/CSS/"><img alt="i usage CSS2" src="/pybimage/icon/css2.png"/></a>
        <br/>
                </li>
                </ul><!--id="BlogrollSubTopic"-->
            </li><!-- powered -->

            <li>
<script charset="Shift_JIS" src="http://chabudai.sakura.ne.jp/blogparts/honehoneclock/honehone_clock_tr.js"></script>
                </li>

        </ul><!-- id="Blogroll" -->

            </div><!-- id="footeractions" class="sidebar"-->
    </td><td>
        <!-- MID function barnners -->
        <div id="zqcategories" class="sidebar">
            <h3>Category</h3>
            <!--
            <a href="/pyblosxom/category-index.html">.:总索引:.</a>
            -->
            <ul class="categorygroup">
<li><ul class="categorygroup">
<li><a href="/pyblosxom/Zen/" class='rootcategory'>Zen/</a><sup>(12)</sup><a href="/pyblosxom/Zen//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><a href="/pyblosxom/Zen/Chinese/">Chinese/</a><sup>(4)</sup><a href="/pyblosxom/Zen/Chinese//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><a href="/pyblosxom/Zen/Google/">Google/</a><sup>(2)</sup><a href="/pyblosxom/Zen/Google//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><a href="/pyblosxom/Zen/IOP/">IOP/</a><sup>(1)</sup><a href="/pyblosxom/Zen/IOP//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><a href="/pyblosxom/Zen/haskell/">haskell/</a><sup>(1)</sup><a href="/pyblosxom/Zen/haskell//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><a href="/pyblosxom/Zen/pythonic/">pythonic/</a><sup>(4)</sup><a href="/pyblosxom/Zen/pythonic//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
</ul></li>
</ul><ul class="categorygroup">
<li><ul class="categorygroup">
<li><a href="/pyblosxom/oss/" class='rootcategory'>oss/</a><sup>(13)</sup><a href="/pyblosxom/oss//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><a href="/pyblosxom/oss/FreeBSD/">FreeBSD/</a><sup>(1)</sup><a href="/pyblosxom/oss/FreeBSD//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><a href="/pyblosxom/oss/Mozilla/">Mozilla/</a><sup>(2)</sup><a href="/pyblosxom/oss/Mozilla//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><ul class="categorygroup">
<li><a href="/pyblosxom/oss/Mozilla/FireFox/">FireFox/</a><sup>(2)</sup><a href="/pyblosxom/oss/Mozilla/FireFox//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
</ul></li>
<li><a href="/pyblosxom/oss/Ubuntu/">Ubuntu/</a><sup>(5)</sup><a href="/pyblosxom/oss/Ubuntu//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
</ul></li>
</ul><ul class="categorygroup">
<li><ul class="categorygroup">
<li><a href="/pyblosxom/opening/" class='rootcategory'>opening/</a><sup>(1)</sup><a href="/pyblosxom/opening//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><a href="/pyblosxom/opening/OpenBookProj/">OpenBookProj/</a><sup>(1)</sup><a href="/pyblosxom/opening/OpenBookProj//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
</ul></li>
</ul><ul class="categorygroup">
<li><ul class="categorygroup">
<li><a href="/pyblosxom/mind/" class='rootcategory'>mind/</a><sup>(2)</sup><a href="/pyblosxom/mind//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
</ul></li>
</ul><ul class="categorygroup">
<li><ul class="categorygroup">
<li><a href="/pyblosxom/Quiet/" class='rootcategory'>Quiet/</a><sup>(10)</sup><a href="/pyblosxom/Quiet//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><a href="/pyblosxom/Quiet/SiFi/">SiFi/</a><sup>(1)</sup><a href="/pyblosxom/Quiet/SiFi//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><a href="/pyblosxom/Quiet/living/">living/</a><sup>(4)</sup><a href="/pyblosxom/Quiet/living//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><a href="/pyblosxom/Quiet/nomeans/">nomeans/</a><sup>(5)</sup><a href="/pyblosxom/Quiet/nomeans//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
</ul></li>
</ul><ul class="categorygroup">
<li><ul class="categorygroup">
<li><a href="/pyblosxom/utility/" class='rootcategory'>utility/</a><sup>(16)</sup><a href="/pyblosxom/utility//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><a href="/pyblosxom/utility/Subversion/">Subversion/</a><sup>(4)</sup><a href="/pyblosxom/utility/Subversion//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><ul class="categorygroup">
<li><a href="/pyblosxom/utility/Subversion/hooks/">hooks/</a><sup>(1)</sup><a href="/pyblosxom/utility/Subversion/hooks//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
</ul></li>
<li><a href="/pyblosxom/utility/py4str/">py4str/</a><sup>(2)</sup><a href="/pyblosxom/utility/py4str//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><ul class="categorygroup">
<li><a href="/pyblosxom/utility/py4str/StructuredText/">StructuredText/</a><sup>(2)</sup><a href="/pyblosxom/utility/py4str/StructuredText//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
</ul></li>
<li><a href="/pyblosxom/utility/py4sys/">py4sys/</a><sup>(2)</sup><a href="/pyblosxom/utility/py4sys//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><a href="/pyblosxom/utility/py4web/">py4web/</a><sup>(4)</sup><a href="/pyblosxom/utility/py4web//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><ul class="categorygroup">
<li><a href="/pyblosxom/utility/py4web/Django/">Django/</a><sup>(1)</sup><a href="/pyblosxom/utility/py4web/Django//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><a href="/pyblosxom/utility/py4web/MoinMoin/">MoinMoin/</a><sup>(2)</sup><a href="/pyblosxom/utility/py4web/MoinMoin//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><a href="/pyblosxom/utility/py4web/Quixote/">Quixote/</a><sup>(1)</sup><a href="/pyblosxom/utility/py4web/Quixote//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
</ul></li>
<li><a href="/pyblosxom/utility/py4xml/">py4xml/</a><sup>(1)</sup><a href="/pyblosxom/utility/py4xml//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><a href="/pyblosxom/utility/py4zh/">py4zh/</a><sup>(2)</sup><a href="/pyblosxom/utility/py4zh//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><a href="/pyblosxom/utility/zqlib/">zqlib/</a><sup>(1)</sup><a href="/pyblosxom/utility/zqlib//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
</ul></li>
</ul><ul class="categorygroup">
<li><ul class="categorygroup">
<li><a href="/pyblosxom/internet/" class='rootcategory'>internet/</a><sup>(7)</sup><a href="/pyblosxom/internet//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><a href="/pyblosxom/internet/Folksonomy/">Folksonomy/</a><sup>(1)</sup><a href="/pyblosxom/internet/Folksonomy//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
</ul></li>
</ul><ul class="categorygroup">
<li><ul class="categorygroup">
<li><a href="/pyblosxom/easy/" class='rootcategory'>easy/</a><sup>(3)</sup><a href="/pyblosxom/easy//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><a href="/pyblosxom/easy/movie/">movie/</a><sup>(1)</sup><a href="/pyblosxom/easy/movie//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><a href="/pyblosxom/easy/music/">music/</a><sup>(2)</sup><a href="/pyblosxom/easy/music//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
</ul></li>
</ul><ul class="categorygroup">
<li><ul class="categorygroup">
<li><a href="/pyblosxom/techic/" class='rootcategory'>techic/</a><sup>(27)</sup><a href="/pyblosxom/techic//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><a href="/pyblosxom/techic/Emacs/">Emacs/</a><sup>(1)</sup><a href="/pyblosxom/techic/Emacs//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><a href="/pyblosxom/techic/Mac/">Mac/</a><sup>(1)</sup><a href="/pyblosxom/techic/Mac//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><a href="/pyblosxom/techic/PyBlosxom/">PyBlosxom/</a><sup>(24)</sup><a href="/pyblosxom/techic/PyBlosxom//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><ul class="categorygroup">
<li><a href="/pyblosxom/techic/PyBlosxom/blosxom/">blosxom/</a><sup>(1)</sup><a href="/pyblosxom/techic/PyBlosxom/blosxom//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
<li><a href="/pyblosxom/techic/PyBlosxom/plugins/">plugins/</a><sup>(10)</sup><a href="/pyblosxom/techic/PyBlosxom/plugins//index.atom"><img src="/pybstyle/rss12x12.png"/></a></li>
</ul></li></ul></li>
</ul>

        </div>
    </td><td>
        <!-- RIGHT function barnners -->
        <div id="montharchives" class="sidebar">
        <h3>Archives</h3>
        <ul class="montharchives">
            <li class='yearchives'><a href='/pyblosxom/2012'>2012</a><sup>(4)</sup></li>
<li><a href="/pyblosxom/2012/06">12.06</a><sup>(1)</sup><li>
<li><a href="/pyblosxom/2012/04">12.04</a><sup>(1)</sup><li>
<li><a href="/pyblosxom/2012/03">12.03</a><sup>(1)</sup><li>
<li><a href="/pyblosxom/2012/02">12.02</a><sup>(1)</sup><li>
<li class='yearchives'><a href='/pyblosxom/2011'>2011</a><sup>(9)</sup></li>
<li><a href="/pyblosxom/2011/10">11.10</a><sup>(2)</sup><li>
<li><a href="/pyblosxom/2011/09">11.09</a><sup>(3)</sup><li>
<li><a href="/pyblosxom/2011/08">11.08</a><sup>(4)</sup><li>
<li class='yearchives'><a href='/pyblosxom/2010'>2010</a><sup>(12)</sup></li>
<li><a href="/pyblosxom/2010/10">10.10</a><sup>(1)</sup><li>
<li><a href="/pyblosxom/2010/09">10.09</a><sup>(1)</sup><li>
<li><a href="/pyblosxom/2010/08">10.08</a><sup>(1)</sup><li>
<li><a href="/pyblosxom/2010/07">10.07</a><sup>(3)</sup><li>
<li><a href="/pyblosxom/2010/05">10.05</a><sup>(4)</sup><li>
<li><a href="/pyblosxom/2010/04">10.04</a><sup>(1)</sup><li>
<li><a href="/pyblosxom/2010/01">10.01</a><sup>(1)</sup><li>
<li class='yearchives'><a href='/pyblosxom/2009'>2009</a><sup>(1)</sup></li>
<li><a href="/pyblosxom/2009/06">09.06</a><sup>(1)</sup><li>
<li class='yearchives'><a href='/pyblosxom/2008'>2008</a><sup>(5)</sup></li>
<li><a href="/pyblosxom/2008/05">08.05</a><sup>(1)</sup><li>
<li><a href="/pyblosxom/2008/04">08.04</a><sup>(4)</sup><li>
<li class='yearchives'><a href='/pyblosxom/2007'>2007</a><sup>(7)</sup></li>
<li><a href="/pyblosxom/2007/10">07.10</a><sup>(2)</sup><li>
<li><a href="/pyblosxom/2007/06">07.06</a><sup>(1)</sup><li>
<li><a href="/pyblosxom/2007/05">07.05</a><sup>(2)</sup><li>
<li><a href="/pyblosxom/2007/04">07.04</a><sup>(1)</sup><li>
<li><a href="/pyblosxom/2007/03">07.03</a><sup>(1)</sup><li>
<li class='yearchives'><a href='/pyblosxom/2006'>2006</a><sup>(50)</sup></li>
<li><a href="/pyblosxom/2006/11">06.11</a><sup>(1)</sup><li>
<li><a href="/pyblosxom/2006/09">06.09</a><sup>(2)</sup><li>
<li><a href="/pyblosxom/2006/06">06.06</a><sup>(3)</sup><li>
<li><a href="/pyblosxom/2006/05">06.05</a><sup>(10)</sup><li>
<li><a href="/pyblosxom/2006/04">06.04</a><sup>(2)</sup><li>
<li><a href="/pyblosxom/2006/03">06.03</a><sup>(5)</sup><li>
<li><a href="/pyblosxom/2006/02">06.02</a><sup>(4)</sup><li>
<li><a href="/pyblosxom/2006/01">06.01</a><sup>(23)</sup><li>
<li class='yearchives'><a href='/pyblosxom/2005'>2005</a><sup>(3)</sup></li>
<li><a href="/pyblosxom/2005/06">05.06</a><sup>(1)</sup><li>
<li><a href="/pyblosxom/2005/04">05.04</a><sup>(2)</sup><li>
<li class='yearchives'><a href='/pyblosxom/2004'>2004</a><sup>(1)</sup></li>
<li><a href="/pyblosxom/2004/04">04.04</a><sup>(1)</sup><li>
        </ul>
        </div>
    </td></tr>
<!--<div id="cloudtags" class="sidebar">
<h3>tags Cloud</h3>

-->
    </table> <!-- class="funcbarnner" -->
<!-- END foot function barnners -->
</div><!-- id="funcbarnner"-->

<div id="footer" class="g33">
&sect;
<a href="#">Z<sub>en</sub>o<sub>f</sub>o<sub>pen</sub>M<sup>ind</sup>. Q<sub>uickly</sub>u<sub>tility</sub>i<sub>nternet</sub>e<sub>asy</sub>t<sup>echnic</sup></a> powered by 
<a href="http://pyblosxom.bluesock.org">
    <img src="http://pyblosxom.bluesock.org/images/pb_pyblosxom.gif" alt="Made with PyBlosxom" border="0" /></a>
v1.5-rc3
|
theme design base <a href="http://www.bestwpthemes.com/doc/">"Doc"</a>
&sect;
<br/>
<a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/cn/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/2.5/cn/88x31.png" /></a>
<br />&#26412;<span xmlns:dc="http://purl.org/dc/elements/1.1/" href="http://purl.org/dc/dcmitype/Text" rel="dc:type">&#20316;&#21697;</span>&#30001;<span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">Zoom.Quiet</span>&#21019;&#20316;&#65292;&#37319;&#29992;<a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/cn/">&#30693;&#35782;&#20849;&#20139;&#32626;&#21517;-&#30456;&#21516;&#26041;&#24335;&#20849;&#20139; 2.5 &#20013;&#22269;&#22823;&#38470;&#35768;&#21487;&#21327;&#35758;</a>&#36827;&#34892;&#35768;&#21487;&#12290;
<!--<br />-->&#22522;&#20110;<a xmlns:dc="http://purl.org/dc/elements/1.1/" href="http://blog.zoomquiet.org" rel="dc:source">blog.zoomquiet.org</a>&#19978;&#30340;&#20316;&#21697;&#21019;&#20316;&#12290;

</div> <!-- id="footer" -->

    <div class="clear"></div> 

</td><!-- id="footer" -->
</tr>
</table><!-- main page structure-->

</div> <!--end for class="container"-->
</body>

<!-- for syntaxhighlighter-->
<link rel="stylesheet" type="text/css" href="/pybshare/syntaxhighlighter_3.0.83/styles/shCore.css"/>
<link rel="stylesheet" type="text/css" href="/pybshare/syntaxhighlighter_3.0.83/styles/shThemeRDark.css"/>
<!-- for syntaxhighlighter required JS files -->
<script type="text/javascript" src="/pybshare/syntaxhighlighter_3.0.83/scripts/shCore.js"></script>
<script type="text/javascript" src="/pybshare/syntaxhighlighter_3.0.83/scripts/shAutoloader.js"></script>
<!-- Finally, to actually run the highlighter, you need to include this JS on your page -->
<script type="text/javascript">
function path(){
    var args = arguments;
    var result = [];
    for(var i = 0; i < args.length; i++){
      result.push(args[i].replace('@', '/pybshare/syntaxhighlighter_3.0.83/scripts/'));
      };
    return result;
    };
SyntaxHighlighter.autoloader.apply(null, path(
    'applescript            @shBrushAppleScript.js',
    'bash shell             @shBrushBash.js',
    'css                    @shBrushCss.js',
    'diff patch pas         @shBrushDiff.js',
    'erl erlang             @shBrushErlang.js',
    'js jscript javascript  @shBrushJScript.js',
    'text plain             @shBrushPlain.js',
    'py python              @shBrushPython.js',
    'rb ruby                @shBrushRuby.js',
    'sass scss              @shBrushSass.js',
    'sql                    @shBrushSql.js',
    'xml xhtml xslt html    @shBrushXml.js'
    ));

SyntaxHighlighter.all()
</script>

<!-- Include the jQuery usage css 
href="http://alexgorbatchev.com/pub/sh/current/styles/shThemeDefault.css"/>
<link rel="stylesheet" type="text/css"  media="print" href="/pybstyle/jQrssPopupBubble.css" />
-->
<!-- Finally, to loading jQuery Ajax Lib. -->
<script type="text/javascript" src="/pybshare/jquery-1.6.2.min.js"></script>
<script src="/pybshare/jquery-pybactions.js" type="text/javascript"></script>


</html>
